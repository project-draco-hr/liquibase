{
  String columnTypeName=rs.getString("TYPE_NAME");
  String columnName=rs.getString("COLUMN_NAME");
  String tableName=rs.getString("TABLE_NAME");
  Map<String,List<String>> tableSchema=new HashMap<String,List<String>>();
  if (!schemaCache.containsKey(tableName)) {
    Statement selectStatement=database.getConnection().createStatement();
    ResultSet rsColumnType=selectStatement.executeQuery("DESC " + tableName);
    while (rsColumnType.next()) {
      List<String> colSchema=new ArrayList<String>();
      colSchema.add(rsColumnType.getString("Type"));
      colSchema.add(rsColumnType.getString("Default"));
      tableSchema.put(rsColumnType.getString("Field"),colSchema);
    }
    rsColumnType.close();
    schemaCache.put(tableName,tableSchema);
  }
  tableSchema=schemaCache.get(tableName);
  if (columnTypeName.toLowerCase().startsWith("enum") || columnTypeName.toLowerCase().startsWith("set")) {
    columnInfo.setTypeName(tableSchema.get(columnName).get(0));
    try {
      String tmpDefaultValue=(String)database.convertDatabaseValueToJavaObject(tableSchema.get(columnName).get(1),columnInfo.getDataType(),columnInfo.getColumnSize(),columnInfo.getDecimalDigits());
      if ("".equals(tmpDefaultValue)) {
        columnInfo.setDefaultValue(null);
      }
 else {
        columnInfo.setDefaultValue(tmpDefaultValue);
      }
    }
 catch (    ParseException e) {
      throw new JDBCException(e);
    }
  }
 else   if (columnTypeName.toLowerCase().equals("text") || columnTypeName.toLowerCase().equals("blob")) {
    columnInfo.setTypeName(columnTypeName);
    columnInfo.setDefaultValue(null);
  }
 else   if (columnTypeName.toLowerCase().equals("timestamp") && !tableSchema.get(columnName).get(1).equals("CURRENT_TIMESTAMP")) {
    columnInfo.setTypeName(columnTypeName);
    columnInfo.setDefaultValue(tableSchema.get(columnName).get(1));
  }
 else {
    super.getColumnTypeAndDefValue(columnInfo,rs,database);
  }
}
