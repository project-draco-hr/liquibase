{
  for (  Database database : TestContext.getInstance().getAllDatabases()) {
    if (database.getConnection() != null) {
      database.checkDatabaseChangeLogLockTable();
      try {
        Connection connection=((JdbcConnection)database.getConnection()).getUnderlyingConnection();
        connection.createStatement().executeUpdate("drop table " + database.getDatabaseChangeLogLockTableName());
        database.commit();
        LockService.getInstance(database).forceReleaseLock();
        ResultSet rs=connection.createStatement().executeQuery("select count(*) from " + database.getDatabaseChangeLogLockTableName());
        rs.next();
        int count=rs.getInt(1);
        LogFactory.getLogger().severe("There are " + count + " rows in databasechangeloglock for "+ database.getTypeName());
        if (count == 0) {
          connection.createStatement().executeUpdate(new InsertGenerator().generateSql(new InsertStatement(database.getLiquibaseSchemaName(),database.getDatabaseChangeLogLockTableName()).addColumnValue("ID",1).addColumnValue("LOCKED",Boolean.FALSE),database,new SqlGeneratorChain(new TreeSet<SqlGenerator>()))[0].toSql());
          LogFactory.getLogger().severe("Added row for " + database.getTypeName());
        }
      }
 catch (      SQLException e) {
      }
    }
  }
}
