{
  LiquibaseProjectComponent liquibaseProjectComponent=LiquibaseProjectComponent.getInstance();
  if (changeLogFile == null) {
    changeLogFile=liquibaseProjectComponent.getRootChangeLogFile();
  }
  Migrator migrator=new Migrator(changeLogFile,new CompositeFileOpener(new IntellijFileOpener(),new FileSystemFileOpener()));
  if (database == null) {
    return migrator;
  }
  try {
    migrator.init(database);
    migrator.checkDatabaseChangeLogTable();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return migrator;
}
