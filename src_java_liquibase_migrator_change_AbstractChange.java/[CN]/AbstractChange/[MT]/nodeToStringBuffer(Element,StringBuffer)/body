{
  buffer.append("<").append(node.getNodeName());
  SortedMap<String,String> attributeMap=new TreeMap<String,String>();
  NamedNodeMap attributes=node.getAttributes();
  for (int i=0; i < attributes.getLength(); i++) {
    Node attribute=attributes.item(i);
    attributeMap.put(attribute.getNodeName(),attribute.getNodeValue());
  }
  for (  Map.Entry entry : attributeMap.entrySet()) {
    Object value=entry.getValue();
    if (value != null) {
      buffer.append(" ").append(entry.getKey()).append("=\"").append(attributeMap.get(value)).append("\"");
    }
  }
  buffer.append(">").append(StringUtils.trimToEmpty(XMLUtil.getTextContent(node)));
  NodeList childNodes=node.getChildNodes();
  for (int i=0; i < childNodes.getLength(); i++) {
    Node childNode=childNodes.item(i);
    if (childNode instanceof Element) {
      nodeToStringBuffer(((Element)childNode),buffer);
    }
  }
  buffer.append("</").append(node.getNodeName()).append(">");
}
