{
  String shouldRunProperty=System.getProperty(Migrator.SHOULD_RUN_SYSTEM_PROPERTY);
  if (shouldRunProperty != null && !Boolean.valueOf(shouldRunProperty)) {
    System.out.println("Migrator did not run because '" + Migrator.SHOULD_RUN_SYSTEM_PROPERTY + "' system property was set to false");
    return;
  }
  CommandLineMigrator commandLineMigrator=new CommandLineMigrator();
  if (args.length == 1 && "--help".equals(args[0])) {
    commandLineMigrator.printHelp(System.out);
    return;
  }
 else   if (args.length == 1 && "--version".equals(args[0])) {
    System.out.println("LiquiBase Version: " + LiquibaseUtil.getBuildVersion() + StreamUtil.getLineSeparator());
    return;
  }
  commandLineMigrator.parseOptions(args);
  File propertiesFile=new File(commandLineMigrator.defaultsFile);
  if (propertiesFile.exists()) {
    commandLineMigrator.parsePropertiesFile(new FileInputStream(propertiesFile));
  }
  List<String> setupMessages=commandLineMigrator.checkSetup();
  if (setupMessages.size() > 0) {
    commandLineMigrator.printHelp(setupMessages,System.out);
    return;
  }
  try {
    commandLineMigrator.applyDefaults();
    commandLineMigrator.configureClassLoader();
    commandLineMigrator.doMigration();
  }
 catch (  Throwable e) {
    String message=e.getMessage();
    if (e.getCause() != null) {
      message=e.getCause().getMessage();
    }
    if (message == null) {
      message="Unknown Reason";
    }
    if (e.getCause() instanceof ValidationFailedException) {
      ((ValidationFailedException)e.getCause()).printDescriptiveError(System.out);
    }
 else {
      System.out.println("Migration Failed: " + message + generateLogLevelWarningMessage());
      LogFactory.getLogger().log(Level.SEVERE,message,e);
    }
    return;
  }
  if ("update".equals(commandLineMigrator.command)) {
    System.out.println("Migration successful");
  }
 else   if (commandLineMigrator.command.startsWith("rollback") && !commandLineMigrator.command.endsWith("SQL")) {
    System.out.println("Rollback successful");
  }
}
