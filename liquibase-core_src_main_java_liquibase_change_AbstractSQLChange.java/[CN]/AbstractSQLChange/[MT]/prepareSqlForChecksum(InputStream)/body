{
  if (stream == null) {
    return "";
  }
  StringBuilder returnString=new StringBuilder();
  String encoding=this.encoding;
  if (encoding == null) {
    encoding="UTF-8";
  }
  Pattern multipleSpaces=Pattern.compile("\\s+");
  try {
    BufferedReader reader=new BufferedReader(new InputStreamReader(stream,encoding));
    String line;
    while ((line=reader.readLine()) != null) {
      String fixedLine=multipleSpaces.matcher(line.trim()).replaceAll(" ");
      if (!fixedLine.equals("")) {
        returnString.append(fixedLine).append(" ");
      }
    }
  }
 catch (  IOException e) {
    throw new UnexpectedLiquibaseException(e);
  }
  if (returnString.length() > 0) {
    returnString.deleteCharAt(returnString.length() - 1);
  }
  return returnString.toString();
}
