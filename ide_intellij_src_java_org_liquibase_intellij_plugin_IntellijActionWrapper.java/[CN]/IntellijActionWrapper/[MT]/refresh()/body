{
  LiquibaseProjectComponent liquibaseProjectComponent=LiquibaseProjectComponent.getInstance();
  DBTree tree=liquibaseProjectComponent.getDbTree();
  if (tree == null) {
    liquibaseProjectComponent.getIdeFacade().showMessage("Operation Complete","Could not auto-refresh the database display\n\nPlease refresh it manually");
    return;
  }
  TreePath pathToRefresh=tree.getSelectionPath().getParentPath();
  Enumeration<TreePath> expandedPaths=tree.getExpandedDescendants(new TreePath(tree.getModel().getRoot()));
  Object c=pathToRefresh.getLastPathComponent();
  if (c instanceof IDBNode) {
    IDBNode dbObject=(IDBNode)c;
    dbObject.refresh();
    DBTreeModel m=(DBTreeModel)tree.getModel();
    m.fireTreeNodeChange(new TreeModelEvent(this,pathToRefresh));
    while (!(dbObject instanceof AbstractDBObject.ProfileNode) && null != dbObject) {
      dbObject=dbObject.getParent();
    }
    if (dbObject != null) {
      AbstractDBObject.ProfileNode dbNode=(AbstractDBObject.ProfileNode)dbObject;
      try {
        dbNode.getDatabase().getResolver().refresh();
      }
 catch (      Exception e1) {
        liquibaseProjectComponent.getIdeFacade().showError(e1);
      }
    }
  }
  while (expandedPaths != null && expandedPaths.hasMoreElements()) {
    TreePath path=expandedPaths.nextElement();
    tree.expandPath(path);
    TreeExpansionListener[] expansionListeners=tree.getListeners(TreeExpansionListener.class);
    for (    TreeExpansionListener listener : expansionListeners) {
      listener.treeExpanded(new TreeExpansionEvent(this,path));
    }
  }
}
