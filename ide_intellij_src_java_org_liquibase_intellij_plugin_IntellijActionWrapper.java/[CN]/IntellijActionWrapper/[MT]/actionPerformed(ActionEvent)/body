{
  Database selectedDatabase=null;
  try {
    selectedDatabase=getSelectedDatabase();
    DatabaseObject selectedDatabaseObject=getSelectedDatabaseObject();
    if (action instanceof BaseRefactorAction) {
      IntellijRefactorWizard wizard=new IntellijRefactorWizard(((BaseRefactorAction)action).createRefactorWizard(selectedDatabaseObject),selectedDatabaseObject,selectedDatabase,((BaseRefactorAction)action));
      wizard.setup();
      wizard.pack();
      wizard.show();
    }
 else     if (action instanceof MigratorAction) {
      ((MigratorAction)action).actionPerform(selectedDatabase,ideFacade);
    }
    if (!selectedDatabase.getAutoCommitMode()) {
      selectedDatabase.commit();
    }
  }
 catch (  LiquibaseException e) {
    ideFacade.showError("Error Executing Change",e);
  }
 finally {
    if (selectedDatabase != null) {
      try {
        selectedDatabase.close();
      }
 catch (      JDBCException e) {
      }
    }
  }
  if (action.needsRefresh()) {
    refresh();
  }
}
