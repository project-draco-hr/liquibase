{
  Database database=createMock(Database.class);
  replay(database);
  LockServiceImpl lockService=new LockServiceImpl();
  lockService.setDatabase(database);
  assertFalse(lockService.hasChangeLogLock());
  Field field=lockService.getClass().getDeclaredField("hasChangeLogLock");
  field.setAccessible(true);
  field.set(lockService,true);
  assertTrue(lockService.hasChangeLogLock());
  assertTrue(lockService.acquireLock());
}
