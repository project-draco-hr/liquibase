{
  Database database=createMock(Database.class);
  Executor executor=createMock(Executor.class);
  List<Map<String,?>> resultList=new ArrayList<Map<String,?>>();
  Map<String,Object> result=new HashMap<String,Object>();
  result.put("ID",1);
  result.put("LOCKED",true);
  Date lockDate=new Date();
  result.put("LOCKGRANTED",lockDate);
  result.put("LOCKEDBY","Locker");
  resultList.add(result);
  expect(executor.queryForList(isA(SelectFromDatabaseChangeLogLockStatement.class))).andReturn(resultList);
  replay(database);
  replay(executor);
  ExecutorService.getInstance().setExecutor(database,executor);
  LockServiceImpl service=new LockServiceImpl();
  service.setDatabase(database);
  DatabaseChangeLogLock[] locks=service.listLocks();
  assertEquals(1,locks.length);
  assertEquals(1,locks[0].getId());
  assertEquals("Locker",locks[0].getLockedBy());
  assertEquals(lockDate,locks[0].getLockGranted());
  verify(database);
}
