{
  Database database=createMock(Database.class);
  expect(database.hasDatabaseChangeLogLockTable()).andReturn(false);
  database.rollback();
  expectLastCall().times(1);
  replay(database);
  LockServiceImpl service=new LockServiceImpl();
  service.setDatabase(database);
  DatabaseChangeLogLock[] locks=service.listLocks();
  assertEquals(0,locks.length);
  verify(database);
}
