{
  for (  Column column : getChangedColumns()) {
    if (!shouldModifyColumn(column)) {
      continue;
    }
    boolean foundDifference=false;
    Column baseColumn=baseSnapshot.getColumn(column);
    if (column.isDataTypeDifferent(baseColumn)) {
      ColumnConfig columnConfig=new ColumnConfig();
      columnConfig.setName(column.getName());
      columnConfig.setType(baseColumn.getDataTypeString(targetDatabase));
      ModifyColumnChange change=new ModifyColumnChange();
      change.setTableName(column.getTable().getName());
      change.setColumn(columnConfig);
      changes.add(change);
      foundDifference=true;
    }
    if (column.isNullabilityDifferent(baseColumn)) {
      if (baseColumn.isNullable() == null || baseColumn.isNullable()) {
        DropNotNullConstraintChange change=new DropNotNullConstraintChange();
        change.setTableName(column.getTable().getName());
        change.setColumnName(column.getName());
        change.setColumnDataType(baseColumn.getDataTypeString(targetDatabase));
        changes.add(change);
        foundDifference=true;
      }
 else {
        AddNotNullConstraintChange change=new AddNotNullConstraintChange();
        change.setTableName(column.getTable().getName());
        change.setColumnName(column.getName());
        change.setColumnDataType(baseColumn.getDataTypeString(targetDatabase));
        changes.add(change);
        foundDifference=true;
      }
    }
    if (!foundDifference) {
      throw new RuntimeException("Unknown difference");
    }
  }
}
