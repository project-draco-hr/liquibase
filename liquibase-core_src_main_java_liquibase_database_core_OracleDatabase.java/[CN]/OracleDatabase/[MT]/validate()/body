{
  ValidationErrors errors=super.validate();
  DatabaseConnection connection=getConnection();
  if (connection == null || connection instanceof OfflineConnection) {
    LogFactory.getInstance().getLog().info("Cannot validate offline database");
    return errors;
  }
  Statement statement=null;
  try {
    statement=((JdbcConnection)connection).createStatement();
    statement.executeQuery("select 1 from dba_recyclebin where 0=1");
    this.canAccessDbaRecycleBin=true;
  }
 catch (  Exception e) {
    if (e instanceof SQLException && e.getMessage().startsWith("ORA-00942")) {
      errors.addWarning("Liquibase needs to access the DBA_RECYCLEBIN table so we can automatically handle the case where constraints are deleted and restored. Since Oracle doesn't properly restore the original table names referenced in the constraint, we use the information from the DBA_RECYCLEBIN to automatically correct this issue.\n" + "\n" + "The user you used to connect to the database (" + getConnection().getConnectionUserName() + ") needs to have \"SELECT ON SYS.DBA_RECYCLEBIN\" permissions set before we can perform this operation. Please run the following SQL to set the appropriate permissions, and try running the command again.\n"+ "\n"+ "     GRANT SELECT ON SYS.DBA_RECYCLEBIN TO "+ getConnection().getConnectionUserName()+ ";");
    }
 else {
      errors.addError(e.getMessage());
    }
  }
 finally {
    JdbcUtils.close(null,statement);
  }
  return errors;
}
