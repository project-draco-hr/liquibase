{
  try {
    CSVReader reader=getCSVReader();
    String[] headers=reader.readNext();
    if (headers == null) {
      throw new UnexpectedLiquibaseException("Data file " + getFile() + " was empty");
    }
    List<SqlStatement> statements=new ArrayList<SqlStatement>();
    String[] line=null;
    int lineNumber=0;
    while ((line=reader.readNext()) != null) {
      lineNumber++;
      if (line.length == 0 || (line.length == 1 && StringUtils.trimToNull(line[0]) == null)) {
        continue;
      }
      InsertStatement insertStatement=this.createStatement(getSchemaName(),getTableName());
      for (int i=0; i < headers.length; i++) {
        String columnName=null;
        if (i >= line.length) {
          throw new UnexpectedLiquibaseException("CSV Line " + lineNumber + " has only "+ (i - 1)+ " columns, the header has "+ headers.length);
        }
        Object value=line[i];
        ColumnConfig columnConfig=getColumnConfig(i,headers[i]);
        if (columnConfig != null) {
          columnName=columnConfig.getName();
          if (value.toString().equalsIgnoreCase("NULL")) {
            value="NULL";
          }
 else           if (columnConfig.getType() != null) {
            ColumnConfig valueConfig=new ColumnConfig();
            if (columnConfig.getType().equalsIgnoreCase("BOOLEAN")) {
              valueConfig.setValueBoolean(Boolean.parseBoolean(value.toString().toLowerCase()));
            }
 else             if (columnConfig.getType().equalsIgnoreCase("NUMERIC")) {
              valueConfig.setValueNumeric(value.toString());
            }
 else             if (columnConfig.getType().toLowerCase().contains("date") || columnConfig.getType().toLowerCase().contains("time")) {
              valueConfig.setValueDate(value.toString());
            }
 else             if (columnConfig.getType().equalsIgnoreCase("STRING")) {
              valueConfig.setValue(value.toString());
            }
 else             if (columnConfig.getType().equalsIgnoreCase("COMPUTED")) {
              valueConfig.setValue(value.toString());
            }
 else {
              throw new UnexpectedLiquibaseException("loadData type of " + columnConfig.getType() + " is not supported.  Please use BOOLEAN, NUMERIC, DATE, STRING, or COMPUTED");
            }
            value=valueConfig.getValueObject();
          }
        }
        if (columnName == null) {
          columnName=headers[i];
        }
        insertStatement.addColumnValue(columnName,value);
      }
      statements.add(insertStatement);
    }
    return statements.toArray(new SqlStatement[statements.size()]);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
