{
  ResourceAccessor opener=getResourceAccessor();
  if (opener == null) {
    throw new UnexpectedLiquibaseException("No file opener specified for " + getFile());
  }
  InputStream stream=opener.getResourceAsStream(getFile());
  if (stream == null) {
    throw new UnexpectedLiquibaseException("Data file " + getFile() + " was not found");
  }
  InputStreamReader streamReader;
  if (getEncoding() == null) {
    streamReader=new InputStreamReader(stream);
  }
 else {
    streamReader=new InputStreamReader(stream,getEncoding());
  }
  CSVReader reader=new CSVReader(streamReader);
  return reader;
}
