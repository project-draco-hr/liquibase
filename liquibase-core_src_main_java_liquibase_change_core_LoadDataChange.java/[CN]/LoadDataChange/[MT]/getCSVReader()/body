{
  ResourceAccessor opener=getResourceAccessor();
  if (opener == null) {
    throw new UnexpectedLiquibaseException("No file opener specified for " + getFile());
  }
  InputStream stream=opener.getResourceAsStream(getFile());
  if (stream == null) {
    throw new UnexpectedLiquibaseException("Data file " + getFile() + " was not found");
  }
  Reader streamReader;
  if (getEncoding() == null) {
    streamReader=new UtfBomAwareReader(stream);
  }
 else {
    streamReader=new UtfBomAwareReader(stream,getEncoding());
  }
  char quotchar;
  if (0 == this.quotchar.length()) {
    quotchar='\1';
  }
 else {
    quotchar=this.quotchar.charAt(0);
  }
  return new CSVReader(streamReader,separator.charAt(0),quotchar);
}
