{
  try {
    if (database.doesChangeLogLockTableExist()) {
      database.comment("Release Database Lock");
      int updatedRows=database.update(new UnlockDatabaseChangeLogStatement(),new ArrayList<SqlVisitor>());
      if (updatedRows != 1) {
        if (database.getExecutor().executesStatements()) {
          throw new LockException("Did not update change log lock correctly.\n\n" + updatedRows + "rows were updated instead of the expected 1 row.");
        }
      }
      database.commit();
      hasChangeLogLock=false;
      instances.remove(this.database);
      LogFactory.getLogger().info("Successfully released change log lock");
    }
  }
 catch (  Exception e) {
    throw new LockException(e);
  }
}
