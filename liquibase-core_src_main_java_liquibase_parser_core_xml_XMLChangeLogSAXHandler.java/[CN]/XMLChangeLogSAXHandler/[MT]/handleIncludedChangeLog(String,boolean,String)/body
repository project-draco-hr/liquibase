{
  if (!(fileName.endsWith(".xml") || fileName.endsWith(".sql"))) {
    log.debug(relativeBaseFileName + "/" + fileName+ " is not a recognized file type");
    return false;
  }
  if (isRelativePath) {
    String path=searchPath(relativeBaseFileName);
    fileName=new StringBuilder(path).append(fileName).toString();
  }
  DatabaseChangeLog changeLog=ChangeLogParserFactory.getInstance().getParser(fileName).parse(fileName,changeLogParameters,resourceAccessor);
  PreconditionContainer preconditions=changeLog.getPreconditions();
  if (preconditions != null) {
    if (null == databaseChangeLog.getPreconditions()) {
      databaseChangeLog.setPreconditions(new PreconditionContainer());
    }
    databaseChangeLog.getPreconditions().addNestedPrecondition(preconditions);
  }
  for (  ChangeSet changeSet : changeLog.getChangeSets()) {
    databaseChangeLog.addChangeSet(changeSet);
  }
  return true;
}
