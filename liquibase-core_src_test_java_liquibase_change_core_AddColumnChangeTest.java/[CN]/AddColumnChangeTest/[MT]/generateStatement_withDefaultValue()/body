{
  AddColumnChange refactoring=new AddColumnChange();
  refactoring.setSchemaName("SCHEMA");
  refactoring.setTableName("TAB");
  ColumnConfig column=new ColumnConfig();
  column.setName("NEWCOL");
  column.setType("TYP");
  column.setValue("SOME VALUE");
  ConstraintsConfig constraints=new ConstraintsConfig();
  constraints.setNullable(Boolean.FALSE);
  constraints.setPrimaryKey(Boolean.TRUE);
  column.setAutoIncrement(Boolean.TRUE);
  column.setConstraints(constraints);
  refactoring.addColumn(column);
  testChangeOnAll(refactoring,new GenerateAllValidator(){
    @Override public void validate(    SqlStatement[] sqlStatements,    Database database){
      if (database instanceof DB2Database) {
        assertEquals(3,sqlStatements.length);
        assertTrue(sqlStatements[0] instanceof AddColumnStatement);
        assertTrue(sqlStatements[1] instanceof ReorganizeTableStatement);
        assertTrue(sqlStatements[2] instanceof UpdateStatement);
      }
 else {
        assertEquals(2,sqlStatements.length);
        assertTrue(sqlStatements[0] instanceof AddColumnStatement);
        assertTrue(sqlStatements[1] instanceof UpdateStatement);
      }
      assertTrue(((AddColumnStatement)sqlStatements[0]).isPrimaryKey());
      assertTrue(((AddColumnStatement)sqlStatements[0]).isAutoIncrement());
      assertEquals("TAB",((UpdateStatement)sqlStatements[sqlStatements.length - 1]).getTableName());
      assertEquals("SOME VALUE",((UpdateStatement)sqlStatements[sqlStatements.length - 1]).getNewColumnValues().get("NEWCOL"));
    }
  }
);
}
