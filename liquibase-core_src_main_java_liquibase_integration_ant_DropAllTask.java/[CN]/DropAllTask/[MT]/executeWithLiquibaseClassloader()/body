{
  if (!shouldRun()) {
    return;
  }
  Liquibase liquibase=null;
  try {
    liquibase=createLiquibase();
    if (StringUtils.trimToNull(schemas) != null) {
      List<String> schemaNames=StringUtils.splitAndTrim(this.schemas,",");
      List<CatalogAndSchema> schemas=new ArrayList<CatalogAndSchema>();
      for (      String name : schemaNames) {
        schemas.add(new CatalogAndSchema(catalog,name));
      }
      liquibase.dropAll(schemas.toArray(new CatalogAndSchema[schemas.size()]));
    }
 else {
      liquibase.dropAll();
    }
  }
 catch (  Exception e) {
    throw new BuildException(e);
  }
 finally {
    closeDatabase(liquibase);
  }
}
