{
  System.out.println("Changing user details for: " + user.getId());
  Session s=factory.openSession();
  Transaction tx=null;
  try {
    tx=s.beginTransaction();
    s.merge(user);
    tx.commit();
  }
 catch (  Exception e) {
    if (tx != null)     tx.rollback();
    throw e;
  }
 finally {
    s.close();
  }
}
