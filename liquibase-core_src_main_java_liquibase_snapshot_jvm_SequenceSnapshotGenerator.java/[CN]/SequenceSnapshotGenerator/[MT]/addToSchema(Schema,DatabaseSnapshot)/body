{
  Database database=snapshot.getDatabase();
  if (!database.supportsSequences()) {
    updateListeners("Sequences not supported for " + database.toString() + " ...");
    return schema;
  }
  List<Sequence> returnSequences=new ArrayList<Sequence>();
  List<String> sequenceNames=(List<String>)ExecutorService.getInstance().getExecutor(database).queryForList(new RawSqlStatement(getSelectSequenceSql(schema,database)),String.class);
  if (sequenceNames != null) {
    for (    String sequenceName : sequenceNames) {
      schema.addDatabaseObject(snapshot.snapshot(new Sequence().setName(sequenceName).setSchema(schema)));
    }
  }
  return schema;
}
