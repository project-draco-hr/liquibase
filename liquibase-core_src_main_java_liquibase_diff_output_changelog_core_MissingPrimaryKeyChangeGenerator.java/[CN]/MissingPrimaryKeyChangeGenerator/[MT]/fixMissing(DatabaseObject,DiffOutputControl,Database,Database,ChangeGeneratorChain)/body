{
  List<Change> returnList=new ArrayList<Change>();
  PrimaryKey pk=(PrimaryKey)missingObject;
  AddPrimaryKeyChange change=new AddPrimaryKeyChange();
  change.setTableName(pk.getTable().getName());
  if (control.getIncludeCatalog()) {
    change.setCatalogName(pk.getTable().getSchema().getCatalogName());
  }
  if (control.getIncludeSchema()) {
    change.setSchemaName(pk.getTable().getSchema().getName());
  }
  change.setConstraintName(pk.getName());
  change.setColumnNames(pk.getColumnNames());
  if (control.getIncludeTablespace()) {
    change.setTablespace(pk.getTablespace());
  }
  if (referenceDatabase instanceof MSSQLDatabase && pk.getBackingIndex() != null && pk.getBackingIndex().getClustered() != null && !pk.getBackingIndex().getClustered()) {
    change.setClustered(false);
  }
  if (comparisonDatabase instanceof OracleDatabase) {
    Index backingIndex=pk.getBackingIndex();
    if (backingIndex != null && backingIndex.getName() != null) {
      try {
        if (!control.getIncludeCatalog() && !control.getIncludeSchema()) {
          backingIndex.getTable().setSchema(null);
        }
        if (!SnapshotGeneratorFactory.getInstance().has(backingIndex,comparisonDatabase)) {
          returnList.addAll(Arrays.asList(ChangeGeneratorFactory.getInstance().fixMissing(backingIndex,control,referenceDatabase,comparisonDatabase)));
        }
      }
 catch (      Exception e) {
        throw new UnexpectedLiquibaseException(e);
      }
      change.setForIndexName(backingIndex.getName());
      Schema schema=backingIndex.getSchema();
      if (schema != null) {
        if (control.getIncludeCatalog()) {
          change.setForIndexCatalogName(schema.getCatalogName());
        }
        if (control.getIncludeSchema()) {
          change.setForIndexSchemaName(schema.getName());
        }
      }
    }
  }
  control.setAlreadyHandledMissing(pk.getBackingIndex());
  returnList.add(change);
  return returnList.toArray(new Change[returnList.size()]);
}
