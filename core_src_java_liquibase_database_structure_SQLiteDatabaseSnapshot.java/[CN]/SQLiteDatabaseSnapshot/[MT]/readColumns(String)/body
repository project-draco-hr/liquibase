{
  updateListeners("Reading columns for " + database.toString() + " ...");
  if (database instanceof SQLiteDatabase) {
    for (    Table cur_table : tablesMap.values()) {
      Statement selectStatement=database.getConnection().createStatement();
      ResultSet rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),cur_table.getName(),null);
      if (rs == null) {
        rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),cur_table.getName(),null);
      }
      while ((rs != null) && rs.next()) {
        Column columnInfo=readColumnInfo(schema,rs);
        if (columnInfo != null) {
          columnsMap.put(columnInfo.getTable().getName() + "." + columnInfo.getName(),columnInfo);
        }
      }
      if (rs != null) {
        rs.close();
      }
      selectStatement.close();
    }
  }
 else {
    Statement selectStatement=database.getConnection().createStatement();
    ResultSet rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),null,null);
    while (rs.next()) {
      Column columnInfo=readColumnInfo(schema,rs);
      if (columnInfo != null) {
        columnsMap.put(columnInfo.getTable().getName() + "." + columnInfo.getName(),columnInfo);
      }
    }
    rs.close();
    selectStatement.close();
  }
}
