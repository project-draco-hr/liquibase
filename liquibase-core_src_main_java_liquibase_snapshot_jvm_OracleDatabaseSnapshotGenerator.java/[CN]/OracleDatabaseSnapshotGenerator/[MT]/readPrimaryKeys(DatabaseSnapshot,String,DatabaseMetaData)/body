{
  Database database=snapshot.getDatabase();
  updateListeners("Reading primary keys for " + database.toString() + " ...");
  List<PrimaryKey> foundPKs=new ArrayList<PrimaryKey>();
  if (schema == null)   schema=database.convertRequestedSchemaToSchema(schema);
  String query="select uc.table_name TABLE_NAME,ucc.column_name COLUMN_NAME,ucc.position KEY_SEQ,uc.constraint_name PK_NAME,ui.tablespace_name TABLESPACE from all_constraints uc,all_indexes ui,all_cons_columns ucc where uc.constraint_type = 'P' and uc.index_name = ui.index_name and uc.constraint_name = ucc.constraint_name and uc.owner = '" + schema + "' and ui.table_owner = '"+ schema+ "' and ucc.owner = '"+ schema+ "'";
  Statement statement=((JdbcConnection)database.getConnection()).getUnderlyingConnection().createStatement();
  ResultSet rs=statement.executeQuery(query);
  while (rs.next()) {
    String tableName=convertFromDatabaseName(rs.getString("TABLE_NAME"));
    String tablespace=convertFromDatabaseName(rs.getString("TABLESPACE"));
    String columnName=convertFromDatabaseName(rs.getString("COLUMN_NAME"));
    short position=rs.getShort("KEY_SEQ");
    boolean foundExistingPK=false;
    for (    PrimaryKey pk : foundPKs) {
      if (pk.getTable().getName().equals(tableName)) {
        pk.addColumnName(position - 1,columnName);
        foundExistingPK=true;
      }
    }
    if (!foundExistingPK && !database.isLiquibaseTable(tableName)) {
      PrimaryKey primaryKey=new PrimaryKey();
      primaryKey.setTablespace(tablespace);
      Table table=snapshot.getTable(tableName);
      if (table == null) {
        continue;
      }
      primaryKey.setTable(table);
      primaryKey.addColumnName(position - 1,columnName);
      primaryKey.setName(convertPrimaryKeyName(rs.getString("PK_NAME")));
      foundPKs.add(primaryKey);
    }
  }
  JdbcUtils.closeResultSet(rs);
  JdbcUtils.closeStatement(statement);
  snapshot.getPrimaryKeys().addAll(foundPKs);
}
