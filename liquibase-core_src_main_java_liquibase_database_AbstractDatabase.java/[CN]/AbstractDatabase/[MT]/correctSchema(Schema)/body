{
  if (schema instanceof Schema.DatabaseSpecific && ((Schema.DatabaseSpecific)schema).getDatabase().equals(this)) {
    return schema;
  }
  if (schema == null) {
    return new Schema.DatabaseSpecific(getDefaultCatalogName(),getDefaultSchemaName(),this);
  }
  String catalogName=schema.getCatalogName();
  String schemaName=schema.getName();
  if (supportsCatalogs() && supportsSchemas()) {
    if (catalogName.equals(Catalog.DEFAULT_NAME)) {
      catalogName=getDefaultCatalogName();
    }
 else {
      catalogName=correctObjectName(catalogName,Catalog.class);
    }
    if (schemaName.equals(Schema.DEFAULT_NAME)) {
      schemaName=getDefaultSchemaName();
    }
 else {
      schemaName=correctObjectName(schemaName,Schema.class);
    }
  }
 else   if (!supportsCatalogs() && !supportsSchemas()) {
    return new Schema.DatabaseSpecific("DEFAULT","DEFAULT",this);
  }
 else   if (supportsCatalogs()) {
    if (catalogName.equals(Catalog.DEFAULT_NAME)) {
      if (Schema.DEFAULT_NAME.equals(schemaName)) {
        catalogName=getDefaultCatalogName();
      }
 else {
        catalogName=schemaName;
      }
    }
    schemaName=catalogName;
  }
 else   if (supportsSchemas()) {
    if (schemaName.equals(Schema.DEFAULT_NAME)) {
      if (Catalog.DEFAULT_NAME.equals(catalogName)) {
        schemaName=getDefaultSchemaName();
      }
 else {
        schemaName=catalogName;
      }
    }
    catalogName=schemaName;
  }
  return new Schema.DatabaseSpecific(catalogName,schemaName,this);
}
