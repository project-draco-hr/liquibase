{
  if (schema instanceof Schema.DatabaseSpecific && ((Schema.DatabaseSpecific)schema).getDatabase().equals(this)) {
    return schema;
  }
  if (schema == null) {
    schema=new Schema.DatabaseSpecific(getDefaultCatalogName(),getDefaultSchemaName(),this);
  }
  String catalogName=schema.getCatalogName();
  String schemaName=schema.getName();
  if (supportsCatalogs()) {
    if (catalogName.equals(Catalog.DEFAULT_NAME)) {
      catalogName=getDefaultCatalogName();
    }
 else {
      catalogName=correctObjectName(catalogName);
    }
  }
 else {
    catalogName=null;
  }
  if (supportsSchemas()) {
    if (schemaName.equals(Schema.DEFAULT_NAME)) {
      schemaName=getDefaultSchemaName();
    }
 else {
      schemaName=correctObjectName(schemaName);
    }
  }
 else {
    schemaName=null;
  }
  return new Schema.DatabaseSpecific(catalogName,schemaName,this);
}
