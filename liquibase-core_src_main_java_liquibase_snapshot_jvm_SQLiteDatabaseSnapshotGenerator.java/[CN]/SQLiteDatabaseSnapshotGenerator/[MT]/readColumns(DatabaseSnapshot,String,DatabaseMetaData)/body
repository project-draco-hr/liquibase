{
  Database database=snapshot.getDatabase();
  updateListeners("Reading columns for " + database.toString() + " ...");
  if (database instanceof SQLiteDatabase) {
    for (    Table cur_table : snapshot.getTables()) {
      Statement selectStatement=null;
      ResultSet rs=null;
      try {
        selectStatement=((JdbcConnection)database.getConnection()).getUnderlyingConnection().createStatement();
        rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),cur_table.getName(),null);
        if (rs == null) {
          rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),cur_table.getName(),null);
        }
        while ((rs != null) && rs.next()) {
          readColumnInfo(snapshot,schema,rs);
        }
      }
  finally {
        if (rs != null) {
          try {
            rs.close();
          }
 catch (          SQLException ignored) {
          }
        }
        if (selectStatement != null) {
          selectStatement.close();
        }
      }
    }
  }
 else {
    Statement selectStatement=null;
    ResultSet rs=null;
    try {
      selectStatement=((JdbcConnection)database.getConnection()).getUnderlyingConnection().createStatement();
      rs=databaseMetaData.getColumns(database.convertRequestedSchemaToCatalog(schema),database.convertRequestedSchemaToSchema(schema),null,null);
      while (rs.next()) {
        readColumnInfo(snapshot,schema,rs);
      }
    }
  finally {
      if (rs != null) {
        try {
          rs.close();
        }
 catch (        SQLException ignored) {
        }
      }
      if (selectStatement != null) {
        selectStatement.close();
      }
    }
  }
}
