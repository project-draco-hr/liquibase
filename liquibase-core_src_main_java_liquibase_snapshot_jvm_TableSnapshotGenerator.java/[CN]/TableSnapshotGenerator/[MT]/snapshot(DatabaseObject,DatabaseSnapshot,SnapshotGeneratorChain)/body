{
  Database database=snapshot.getDatabase();
  if (example instanceof Table) {
    String objectName=example.getName();
    Schema schema=example.getSchema();
    ResultSet rs=null;
    try {
      DatabaseMetaData metaData=getMetaData(database);
      rs=metaData.getTables(database.getJdbcCatalogName(schema),database.getJdbcSchemaName(schema),database.correctObjectName(objectName,Table.class),new String[]{"TABLE"});
      Table table;
      try {
        if (rs.next()) {
          table=readTable(rs,database);
        }
 else {
          return null;
        }
      }
  finally {
        rs.close();
      }
      return table;
    }
 catch (    SQLException e) {
      throw new DatabaseException(e);
    }
 finally {
      if (rs != null) {
        try {
          rs.close();
        }
 catch (        SQLException ignore) {
        }
      }
    }
  }
 else   if (example instanceof Schema) {
    Schema schema=(Schema)chain.snapshot(example,snapshot);
    if (schema != null) {
      ResultSet tableMetaDataRs=null;
      try {
        tableMetaDataRs=getMetaData(database).getTables(database.getJdbcCatalogName(schema),database.getJdbcSchemaName(schema),null,new String[]{"TABLE"});
        while (tableMetaDataRs.next()) {
          String tableName=tableMetaDataRs.getString("TABLE_NAME");
          Table tableExample=(Table)new Table().setName(tableName).setSchema(schema);
          schema.addDatabaseObject(snapshot.snapshot(tableExample));
        }
      }
 catch (      SQLException e) {
        throw new DatabaseException(e);
      }
 finally {
        try {
          if (tableMetaDataRs != null) {
            tableMetaDataRs.close();
          }
        }
 catch (        SQLException ignore) {
        }
      }
    }
    return schema;
  }
 else {
    throw new UnexpectedLiquibaseException("Unexpected snapshot example: " + example.getClass().getName());
  }
}
