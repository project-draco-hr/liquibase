{
  String sql="SELECT " + StringUtils.join(statement.getColumnsToSelect(),",") + " FROM "+ database.escapeTableName(database.getLiquibaseSchemaName(),database.getDatabaseChangeLogTableName());
  SelectFromDatabaseChangeLogStatement.WhereClause whereClause=statement.getWhereClause();
  if (whereClause != null) {
    if (whereClause instanceof SelectFromDatabaseChangeLogStatement.ByTag) {
      sql+=" WHERE tag='" + ((SelectFromDatabaseChangeLogStatement.ByTag)whereClause).getTagName() + "'";
    }
 else {
      throw new UnexpectedLiquibaseException("Unknown where clause type: " + whereClause.getClass().getName());
    }
  }
  if (statement.getOrderByColumns().length > 0) {
    sql+=" ORDER BY " + StringUtils.join(statement.getOrderByColumns(),", ");
  }
  return new Sql[]{new UnparsedSql(sql)};
}
