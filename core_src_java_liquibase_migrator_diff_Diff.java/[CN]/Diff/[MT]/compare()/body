{
  try {
    baseSnapshot=new DatabaseSnapshot(baseDatabase,statusListeners);
    if (targetDatabase == null) {
      targetSnapshot=new DatabaseSnapshot();
    }
 else {
      targetSnapshot=new DatabaseSnapshot(targetDatabase,statusListeners);
    }
    DiffResult diffResult=new DiffResult(baseDatabase,targetDatabase);
    checkVersionInfo(diffResult);
    checkTables(diffResult);
    checkViews(diffResult);
    checkColumns(diffResult);
    checkForeignKeys(diffResult);
    checkPrimaryKeys(diffResult);
    checkIndexes(diffResult);
    checkSequences(diffResult);
    return diffResult;
  }
 catch (  SQLException e) {
    throw new JDBCException();
  }
}
