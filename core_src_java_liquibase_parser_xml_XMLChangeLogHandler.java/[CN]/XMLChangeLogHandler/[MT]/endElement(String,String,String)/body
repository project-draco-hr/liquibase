{
  String textString=null;
  if (text != null && text.length() > 0) {
    textString=expandExpressions(StringUtils.trimToNull(text.toString()));
  }
  try {
    if (rootPrecondition != null) {
      if ("preConditions".equals(qName)) {
        databaseChangeLog.setPreconditions(rootPrecondition);
        handlePreCondition(rootPrecondition);
        rootPrecondition=null;
      }
 else       if ("and".equals(qName)) {
        preconditionLogicStack.pop();
        currentPrecondition=null;
      }
 else       if ("or".equals(qName)) {
        preconditionLogicStack.pop();
        currentPrecondition=null;
      }
 else       if ("not".equals(qName)) {
        preconditionLogicStack.pop();
        currentPrecondition=null;
      }
 else       if (qName.equals("sqlCheck")) {
        ((SqlPrecondition)currentPrecondition).setSql(textString);
        currentPrecondition=null;
      }
    }
 else     if (changeSet != null && "rollback".equals(qName)) {
      changeSet.addRollBackSQL(textString);
      inRollback=false;
    }
 else     if (change != null && change instanceof RawSQLChange && "comment".equals(qName)) {
      ((RawSQLChange)change).setComments(textString);
      text=new StringBuffer();
    }
 else     if (change != null && "where".equals(qName)) {
      if (change instanceof UpdateDataChange) {
        ((UpdateDataChange)change).setWhereClause(textString);
      }
 else       if (change instanceof DeleteDataChange) {
        ((DeleteDataChange)change).setWhereClause(textString);
      }
 else {
        throw new RuntimeException("Unexpected change type: " + change.getClass().getName());
      }
      text=new StringBuffer();
    }
 else     if (change != null && change instanceof CreateProcedureChange && "comment".equals(qName)) {
      ((CreateProcedureChange)change).setComments(textString);
      text=new StringBuffer();
    }
 else     if (changeSet != null && "comment".equals(qName)) {
      changeSet.setComments(textString);
      text=new StringBuffer();
    }
 else     if (changeSet != null && "changeSet".equals(qName)) {
      handleChangeSet(changeSet);
      changeSet=null;
    }
 else     if (change != null && qName.equals(change.getTagName())) {
      if (textString != null) {
        if (change instanceof RawSQLChange) {
          ((RawSQLChange)change).setSql(textString);
        }
 else         if (change instanceof CreateProcedureChange) {
          ((CreateProcedureChange)change).setProcedureBody(textString);
        }
 else         if (change instanceof CreateViewChange) {
          ((CreateViewChange)change).setSelectQuery(textString);
        }
 else         if (change instanceof InsertDataChange) {
          List<ColumnConfig> columns=((InsertDataChange)change).getColumns();
          columns.get(columns.size() - 1).setValue(textString);
        }
 else         if (change instanceof UpdateDataChange) {
          List<ColumnConfig> columns=((UpdateDataChange)change).getColumns();
          columns.get(columns.size() - 1).setValue(textString);
        }
 else {
          throw new RuntimeException("Unexpected text in " + change.getTagName());
        }
      }
      text=null;
      if (inRollback) {
        changeSet.addRollbackChange(change);
      }
 else {
        changeSet.addChange(change);
      }
      change=null;
    }
 else     if (changeSet != null && "validCheckSum".equals(qName)) {
      changeSet.addValidCheckSum(text.toString());
      text=null;
    }
  }
 catch (  Exception e) {
    log.log(Level.SEVERE,"Error thrown as a SAXException: " + e.getMessage(),e);
    throw new SAXException(databaseChangeLog.getPhysicalFilePath() + ": " + e.getMessage(),e);
  }
}
