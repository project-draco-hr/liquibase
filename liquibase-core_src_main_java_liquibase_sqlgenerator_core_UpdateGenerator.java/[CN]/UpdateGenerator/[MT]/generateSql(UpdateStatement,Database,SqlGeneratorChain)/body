{
  StringBuffer sql=new StringBuffer("UPDATE " + database.escapeTableName(statement.getCatalogName(),statement.getSchemaName(),statement.getTableName()) + " SET");
  for (  String column : statement.getNewColumnValues().keySet()) {
    sql.append(" ").append(database.escapeColumnName(statement.getCatalogName(),statement.getSchemaName(),statement.getTableName(),column)).append(" = ");
    sql.append(convertToString(statement.getNewColumnValues().get(column),database));
    sql.append(",");
  }
  sql.deleteCharAt(sql.lastIndexOf(","));
  if (statement.getWhereClause() != null) {
    String fixedWhereClause="WHERE " + statement.getWhereClause().trim();
    for (    String columnName : statement.getWhereColumnNames()) {
      if (columnName == null) {
        continue;
      }
      fixedWhereClause=fixedWhereClause.replaceFirst(":name",database.escapeObjectName(columnName,Column.class));
    }
    for (    Object param : statement.getWhereParameters()) {
      fixedWhereClause=fixedWhereClause.replaceFirst("\\?|:value",DataTypeFactory.getInstance().fromObject(param,database).objectToSql(param,database));
    }
    sql.append(" ").append(fixedWhereClause);
  }
  return new Sql[]{new UnparsedSql(sql.toString())};
}
