{
  updateListeners("Reading primary keys for " + database.toString() + " ...");
  List<PrimaryKey> foundPKs=new ArrayList<PrimaryKey>();
  for (  Table table : tablesMap.values()) {
    ResultSet rs=databaseMetaData.getPrimaryKeys(database.getCatalogName(),database.getSchemaName(),table.getName());
    while (rs.next()) {
      String tableName=rs.getString("TABLE_NAME");
      String columnName=rs.getString("COLUMN_NAME");
      short position=rs.getShort("KEY_SEQ");
      boolean foundExistingPK=false;
      for (      PrimaryKey pk : foundPKs) {
        if (pk.getTableName().equals(tableName)) {
          pk.addColumnName(position - 1,columnName);
          foundExistingPK=true;
        }
      }
      if (!foundExistingPK) {
        PrimaryKey primaryKey=new PrimaryKey();
        primaryKey.setTableName(tableName);
        primaryKey.addColumnName(position - 1,columnName);
        primaryKey.setName(rs.getString("PK_NAME"));
        foundPKs.add(primaryKey);
      }
    }
    rs.close();
  }
  this.primaryKeys.addAll(foundPKs);
}
