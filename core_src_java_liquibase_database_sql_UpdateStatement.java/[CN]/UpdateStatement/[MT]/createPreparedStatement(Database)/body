{
  StringBuffer sql=new StringBuffer("UPDATE " + tableName + " SET");
  List<Object> params=new ArrayList<Object>();
  List<Integer> types=new ArrayList<Integer>();
  for (  String column : newColumnValues.keySet()) {
    sql.append(" ").append(column).append(" = ?,");
    params.add(newColumnValues.get(column));
    types.add(newColumnTypes.get(column));
  }
  sql.deleteCharAt(sql.lastIndexOf(","));
  if (whereClause != null) {
    sql.append(" where ").append(whereClause);
  }
  PreparedStatement pstmt=database.getConnection().prepareStatement(sql.toString());
  params.addAll(whereParameters);
  types.addAll(whereParameterTypes);
  for (int i=0; i < params.size(); i++) {
    Object param=params.get(i);
    int type=database.getDatabaseType(types.get(i));
    if (param == null) {
      pstmt.setNull(i + 1,type);
    }
 else {
      pstmt.setObject(i + 1,param,type);
    }
  }
  return pstmt;
}
