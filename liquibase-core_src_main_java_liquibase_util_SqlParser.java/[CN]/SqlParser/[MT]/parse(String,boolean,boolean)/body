{
  StringClauses clauses=new StringClauses(preserveWhitespace ? "" : " ");
  SimpleSqlGrammar t=new SimpleSqlGrammar(new StringReader(sqlBlock));
  try {
    Token token=t.getNextToken();
    while (!token.toString().equals("")) {
      if (token.kind == SimpleSqlGrammarConstants.WHITESPACE) {
        if (preserveWhitespace) {
          clauses.append(new StringClauses.Whitespace(token.image));
        }
      }
 else       if (token.kind == SimpleSqlGrammarConstants.LINE_COMMENT || token.kind == SimpleSqlGrammarConstants.MULTI_LINE_COMMENT) {
        if (preserveComments) {
          clauses.append(new StringClauses.Comment(token.image));
          if (!preserveWhitespace) {
            clauses.append(new StringClauses.Whitespace("\n"));
          }
        }
      }
 else {
        clauses.append(token.image);
      }
      token=t.getNextToken();
    }
  }
 catch (  Exception e) {
    throw new UnexpectedLiquibaseException(e);
  }
  return clauses;
}
