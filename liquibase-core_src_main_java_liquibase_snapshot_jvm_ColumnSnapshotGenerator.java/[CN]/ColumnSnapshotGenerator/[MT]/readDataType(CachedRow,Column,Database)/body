{
  String columnTypeName=(String)columnMetadataResultSet.get("TYPE_NAME");
  if (database instanceof FirebirdDatabase) {
    if (columnTypeName.equals("BLOB SUB_TYPE 0")) {
      columnTypeName="BLOB";
    }
    if (columnTypeName.equals("BLOB SUB_TYPE 1")) {
      columnTypeName="CLOB";
    }
  }
  DataType.ColumnSizeUnit columnSizeUnit=DataType.ColumnSizeUnit.BYTE;
  int dataType=columnMetadataResultSet.getInt("DATA_TYPE");
  Integer columnSize=columnMetadataResultSet.getInt("COLUMN_SIZE");
  if (database.dataTypeIsNotModifiable(columnTypeName)) {
    columnSize=null;
  }
 else   if (database instanceof OracleDatabase && columnTypeName.equals("NVARCHAR2")) {
    columnSize=columnSize / 2;
    columnSizeUnit=DataType.ColumnSizeUnit.CHAR;
  }
  Integer decimalDigits=columnMetadataResultSet.getInt("DECIMAL_DIGITS");
  if (decimalDigits != null && decimalDigits.equals(0)) {
    decimalDigits=null;
  }
  Integer radix=columnMetadataResultSet.getInt("NUM_PREC_RADIX");
  Integer characterOctetLength=columnMetadataResultSet.getInt("CHAR_OCTET_LENGTH");
  DataType type=new DataType(columnTypeName);
  type.setDataTypeId(dataType);
  type.setColumnSize(columnSize);
  type.setDecimalDigits(decimalDigits);
  type.setRadix(radix);
  type.setCharacterOctetLength(characterOctetLength);
  type.setColumnSizeUnit(columnSizeUnit);
  return type;
}
