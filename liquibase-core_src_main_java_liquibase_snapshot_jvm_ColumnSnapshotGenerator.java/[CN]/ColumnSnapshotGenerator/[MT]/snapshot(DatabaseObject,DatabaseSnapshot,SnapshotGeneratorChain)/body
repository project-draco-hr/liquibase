{
  Database database=snapshot.getDatabase();
  if (example instanceof Column) {
    Relation relation=((Column)example).getRelation();
    Schema schema=relation.getSchema();
    ResultSet columnMetadataRs=null;
    try {
      DatabaseMetaData databaseMetaData=getMetaData(database);
      columnMetadataRs=databaseMetaData.getColumns(database.getJdbcCatalogName(schema),database.getJdbcSchemaName(schema),relation.getName(),((Column)example).getName());
      if (columnMetadataRs.next()) {
        Map<String,Object> data=convertResultSetToMap(columnMetadataRs);
        return readColumn(data,relation,database);
      }
 else {
        return null;
      }
    }
 catch (    Exception e) {
      throw new DatabaseException(e);
    }
 finally {
      if (columnMetadataRs != null) {
        try {
          columnMetadataRs.close();
        }
 catch (        SQLException ignored) {
        }
      }
    }
  }
 else   if (example instanceof Relation) {
    Relation relation=(Relation)chain.snapshot(example,snapshot);
    if (relation != null) {
      ResultSet allColumnsMetadataRs=null;
      try {
        DatabaseMetaData databaseMetaData=getMetaData(database);
        Schema schema;
        schema=relation.getSchema();
        allColumnsMetadataRs=databaseMetaData.getColumns(database.getJdbcCatalogName(schema),database.getJdbcSchemaName(schema),relation.getName(),null);
        while (allColumnsMetadataRs.next()) {
          Column exampleColumn=new Column().setRelation(relation).setName(allColumnsMetadataRs.getString("COLUMN_NAME"));
          relation.getColumns().add(snapshot.snapshot(exampleColumn));
        }
      }
 catch (      Exception e) {
        throw new DatabaseException(e);
      }
 finally {
        if (allColumnsMetadataRs != null) {
          try {
            allColumnsMetadataRs.close();
          }
 catch (          SQLException ignored) {
          }
        }
      }
    }
    return relation;
  }
 else {
    throw new UnexpectedLiquibaseException("Unexpected snapshot example: " + example.getClass().getName());
  }
}
