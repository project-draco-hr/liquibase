{
  String currentSchemaName;
  String currentCatalogName;
  try {
    currentSchemaName=getSchemaName() == null ? (database == null ? null : database.getDefaultSchemaName()) : getSchemaName();
    currentCatalogName=getCatalogName() == null ? (database == null ? null : database.getDefaultCatalogName()) : getCatalogName();
    Schema schema=new Schema(currentCatalogName,currentSchemaName);
    if (database != null) {
      schema=database.correctSchema(schema);
    }
    if (!DatabaseSnapshotGeneratorFactory.getInstance().getGenerator(database).hasIndex(schema,getTableName(),getIndexName(),database,getColumnNames())) {
      String name="";
      if (getIndexName() != null) {
        name+=database.escapeStringForDatabase(getIndexName());
      }
      if (StringUtils.trimToNull(getTableName()) != null) {
        name+=" on " + database.escapeStringForDatabase(getTableName());
        if (StringUtils.trimToNull(getColumnNames()) != null) {
          name+=" columns " + getColumnNames();
        }
      }
      throw new PreconditionFailedException("Index " + name + " does not exist",changeLog,this);
    }
  }
 catch (  DatabaseException e) {
    throw new PreconditionErrorException(e,changeLog,this);
  }
}
