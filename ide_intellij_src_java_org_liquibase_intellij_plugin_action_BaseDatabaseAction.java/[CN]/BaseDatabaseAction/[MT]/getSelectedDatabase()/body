{
  Object selectedObject=getUserData();
  if (selectedObject instanceof DBTree) {
    TreePath selectionPath=((DBTree)getUserData()).getSelectionModel().getLeadSelectionPath();
    selectedObject=selectionPath.getPathComponent(1);
  }
  if (selectedObject instanceof Catalog) {
    return ((Catalog)selectedObject).getDatabase();
  }
 else   if (selectedObject instanceof Column) {
    return ((Column)selectedObject).getTable().getDatabase();
  }
 else   if (selectedObject instanceof Schema) {
    return ((Schema)selectedObject).getDatabase();
  }
 else   if (selectedObject instanceof Table) {
    return ((Table)selectedObject).getDatabase();
  }
 else   if (selectedObject instanceof AbstractDBObject.ProfileNode) {
    return ((AbstractDBObject.ProfileNode)selectedObject).getDatabase();
  }
 else {
    throw new RuntimeException("Unknown object type: " + selectedObject.getClass().getName());
  }
}
