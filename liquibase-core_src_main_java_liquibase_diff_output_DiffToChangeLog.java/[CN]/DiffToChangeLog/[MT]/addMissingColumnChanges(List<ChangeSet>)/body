{
  for (  Column column : diffResult.getObjectDiff(Column.class).getMissing()) {
    if (!shouldModifyColumn(column)) {
      continue;
    }
    AddColumnChange change=new AddColumnChange();
    change.setTableName(column.getRelation().getName());
    change.setCatalogName(column.getRelation().getSchema().getCatalog().getName());
    change.setSchemaName(column.getRelation().getSchema().getName());
    ColumnConfig columnConfig=new ColumnConfig();
    columnConfig.setName(column.getName());
    String dataType=column.getType().toString();
    columnConfig.setType(dataType);
    Object defaultValue=column.getDefaultValue();
    if (defaultValue != null) {
      String defaultValueString=DataTypeFactory.getInstance().from(column.getType()).objectToString(defaultValue,diffResult.getReferenceSnapshot().getDatabase());
      if (defaultValueString != null) {
        defaultValueString=defaultValueString.replaceFirst("'","").replaceAll("'$","");
      }
      columnConfig.setDefaultValue(defaultValueString);
    }
    if (column.getRemarks() != null) {
      columnConfig.setRemarks(column.getRemarks());
    }
    ConstraintsConfig constraintsConfig=columnConfig.getConstraints();
    if (column.isNullable() != null && !column.isNullable()) {
      if (constraintsConfig == null) {
        constraintsConfig=new ConstraintsConfig();
      }
      constraintsConfig.setNullable(false);
    }
    if (column.isUnique()) {
      if (constraintsConfig == null) {
        constraintsConfig=new ConstraintsConfig();
      }
      constraintsConfig.setUnique(true);
    }
    if (constraintsConfig != null) {
      columnConfig.setConstraints(constraintsConfig);
    }
    change.addColumn(columnConfig);
    changes.add(generateChangeSet(change));
  }
}
