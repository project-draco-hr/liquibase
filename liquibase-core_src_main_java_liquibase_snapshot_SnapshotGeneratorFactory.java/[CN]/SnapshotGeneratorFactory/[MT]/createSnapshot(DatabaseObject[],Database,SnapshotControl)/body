{
  if (database.getConnection() instanceof OfflineConnection) {
    String snapshotFile=((OfflineConnection)database.getConnection()).getSnapshotFile();
    if (snapshotFile == null) {
      throw new DatabaseException("No snapshotFile parameter specified for offline database");
    }
    try {
      FileSystemResourceAccessor resourceAccessor=new FileSystemResourceAccessor();
      SnapshotParser parser=SnapshotParserFactory.getInstance().getParser(snapshotFile,resourceAccessor);
      return parser.parse(snapshotFile,database,resourceAccessor);
    }
 catch (    LiquibaseException e) {
      throw new DatabaseException(e);
    }
  }
  return new JdbcDatabaseSnapshot(examples,database,snapshotControl);
}
