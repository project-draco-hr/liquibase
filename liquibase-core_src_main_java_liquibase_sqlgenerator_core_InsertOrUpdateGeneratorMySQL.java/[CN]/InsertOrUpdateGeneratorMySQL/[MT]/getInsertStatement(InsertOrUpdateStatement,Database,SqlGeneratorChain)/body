{
  StringBuffer sql=new StringBuffer(super.getInsertStatement(insertOrUpdateStatement,database,sqlGeneratorChain));
  sql.deleteCharAt(sql.lastIndexOf(";"));
  StringBuffer updateClause=new StringBuffer("ON DUPLICATE KEY UPDATE ");
  String[] pkFields=insertOrUpdateStatement.getPrimaryKey().split(",");
  HashSet<String> hashPkFields=new HashSet<String>(Arrays.asList(pkFields));
  boolean hasFields=false;
  for (  String columnKey : insertOrUpdateStatement.getColumnValues().keySet()) {
    if (!hashPkFields.contains(columnKey)) {
      hasFields=true;
      updateClause.append(columnKey).append(" = ");
      updateClause.append(convertToString(insertOrUpdateStatement.getColumnValue(columnKey),database));
      updateClause.append(",");
    }
  }
  updateClause.deleteCharAt(updateClause.lastIndexOf(","));
  if (hasFields) {
    sql.append(updateClause);
  }
 else {
    sql.insert(sql.indexOf("INSERT ") + "INSERT ".length(),"IGNORE ");
  }
  return sql.toString();
}
