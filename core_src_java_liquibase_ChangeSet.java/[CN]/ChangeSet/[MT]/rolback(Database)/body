{
  try {
    database.getJdbcTemplate().comment("Rolling Back ChangeSet: " + toString());
    if (rollBackStatements != null && rollBackStatements.size() > 0) {
      for (      SqlStatement rollback : rollBackStatements) {
        try {
          database.getJdbcTemplate().execute(rollback);
        }
 catch (        JDBCException e) {
          throw new RollbackFailedException("Error executing custom SQL [" + rollback.getSqlStatement(database) + "]",e);
        }
      }
    }
 else {
      List<Change> changes=getChanges();
      for (int i=changes.size() - 1; i >= 0; i--) {
        Change change=changes.get(i);
        change.executeRollbackStatements(database);
        log.finest(change.getConfirmationMessage());
      }
    }
    database.commit();
    log.finest("ChangeSet " + toString() + " has been successfully rolled back.");
  }
 catch (  Exception e) {
    throw new RollbackFailedException(e);
  }
}
