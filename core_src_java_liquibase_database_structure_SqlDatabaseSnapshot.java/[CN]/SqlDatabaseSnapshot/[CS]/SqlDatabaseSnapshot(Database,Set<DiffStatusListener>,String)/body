{
  if (requestedSchema == null) {
    requestedSchema=database.getDefaultSchemaName();
  }
  try {
    this.schema=requestedSchema;
    this.database=database;
    if (database.getConnection() != null) {
      this.databaseMetaData=database.getConnection().getMetaData();
    }
    this.statusListeners=statusListeners;
    readTablesAndViews(requestedSchema);
    readForeignKeyInformation(requestedSchema);
    readPrimaryKeys(requestedSchema);
    readColumns(requestedSchema);
    readUniqueConstraints(requestedSchema);
    readIndexes(requestedSchema);
    readSequences(requestedSchema);
    this.tables=new HashSet<Table>(tablesMap.values());
    this.views=new HashSet<View>(viewsMap.values());
    this.columns=new HashSet<Column>(columnsMap.values());
  }
 catch (  SQLException e) {
    throw new JDBCException(e);
  }
}
