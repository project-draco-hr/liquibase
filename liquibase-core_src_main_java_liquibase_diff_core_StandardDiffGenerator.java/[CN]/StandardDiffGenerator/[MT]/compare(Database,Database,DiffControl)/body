{
  DatabaseSnapshot referenceSnapshot=null;
  DatabaseSnapshot comparisonSnapshot=null;
  referenceSnapshot=SnapshotGeneratorFactory.getInstance().createSnapshot(diffControl.getSchemas(DiffControl.DatabaseRole.REFERENCE),referenceDatabase,diffControl.toSnapshotControl(DiffControl.DatabaseRole.REFERENCE));
  comparisonSnapshot=null;
  if (comparisonDatabase != null) {
    comparisonSnapshot=SnapshotGeneratorFactory.getInstance().createSnapshot(diffControl.getSchemas(DiffControl.DatabaseRole.COMPARISON),comparisonDatabase,diffControl.toSnapshotControl(DiffControl.DatabaseRole.COMPARISON));
  }
  return compare(referenceSnapshot,comparisonSnapshot,diffControl);
}
