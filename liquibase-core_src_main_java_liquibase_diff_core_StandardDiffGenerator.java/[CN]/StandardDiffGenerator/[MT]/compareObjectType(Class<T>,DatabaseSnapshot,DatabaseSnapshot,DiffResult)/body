{
  for (  DiffControl.SchemaComparison schemaComparison : diffResult.getDiffControl().getSchemaComparisons()) {
    Schema referenceSchema=referenceSnapshot.getDatabase().correctSchema(schemaComparison.getReferenceSchema());
    Schema comparisonSchema=null;
    if (comparisonSnapshot.getDatabase() != null) {
      comparisonSchema=comparisonSnapshot.getDatabase().correctSchema(schemaComparison.getComparisonSchema());
    }
    for (    T referenceObject : referenceSnapshot.getDatabaseObjects(referenceSchema,type)) {
      if (referenceObject instanceof Table && referenceSnapshot.getDatabase().isLiquibaseTable(referenceSchema,referenceObject.getName())) {
        continue;
      }
      if (comparisonSnapshot.contains(comparisonSchema,referenceObject)) {
        if (!comparisonSnapshot.matches(comparisonSchema,referenceObject)) {
          diffResult.getObjectDiff(type).addChanged(referenceObject);
        }
      }
 else {
        diffResult.getObjectDiff(type).addMissing(referenceObject);
      }
    }
    for (    T targetObject : comparisonSnapshot.getDatabaseObjects(comparisonSchema,type)) {
      if (targetObject instanceof Table && comparisonSnapshot.getDatabase().isLiquibaseTable(comparisonSchema,targetObject.getName())) {
        continue;
      }
      if (!referenceSnapshot.contains(referenceSchema,targetObject)) {
        diffResult.getObjectDiff(type).addUnexpected(targetObject);
      }
    }
  }
}
