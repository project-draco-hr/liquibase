{
  DatabaseChangeLog changeLog=new MockFormattedSqlChangeLogParser(VALID_CHANGELOG).parse("asdf.sql",new ChangeLogParameters(),new JUnitResourceAccessor());
  assertEquals("asdf.sql",changeLog.getLogicalFilePath());
  assertEquals(3,changeLog.getChangeSets().size());
  assertEquals("nvoxland",changeLog.getChangeSets().get(0).getAuthor());
  assertEquals("1",changeLog.getChangeSets().get(0).getId());
  assertEquals(1,changeLog.getChangeSets().get(0).getChanges().size());
  assertEquals("select * from table1;",((RawSQLChange)changeLog.getChangeSets().get(0).getChanges().get(0)).getSql());
  assertNull(((RawSQLChange)changeLog.getChangeSets().get(0).getChanges().get(0)).getEndDelimiter());
  assertTrue(((RawSQLChange)changeLog.getChangeSets().get(0).getChanges().get(0)).isSplittingStatements());
  assertTrue(((RawSQLChange)changeLog.getChangeSets().get(0).getChanges().get(0)).isStrippingComments());
  assertFalse(changeLog.getChangeSets().get(0).isAlwaysRun());
  assertFalse(changeLog.getChangeSets().get(0).isRunOnChange());
  assertTrue(changeLog.getChangeSets().get(0).isRunInTransaction());
  assertNull(changeLog.getChangeSets().get(0).getContexts());
  assertNull(changeLog.getChangeSets().get(0).getDbmsSet());
  assertEquals("nvoxland",changeLog.getChangeSets().get(1).getAuthor());
  assertEquals("2",changeLog.getChangeSets().get(1).getId());
  assertEquals(1,changeLog.getChangeSets().get(1).getChanges().size());
  assertEquals("create table table1 (\n" + "  id int primary key\n" + ");",((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).getSql());
  assertEquals("X",((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).getEndDelimiter());
  assertFalse(((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).isSplittingStatements());
  assertFalse(((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).isStrippingComments());
  assertEquals("X",((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).getEndDelimiter());
  assertFalse(((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).isSplittingStatements());
  assertFalse(((RawSQLChange)changeLog.getChangeSets().get(1).getChanges().get(0)).isStrippingComments());
  assertTrue(changeLog.getChangeSets().get(1).isAlwaysRun());
  assertTrue(changeLog.getChangeSets().get(1).isRunOnChange());
  assertFalse(changeLog.getChangeSets().get(1).isRunInTransaction());
  assertEquals("y",StringUtils.join(changeLog.getChangeSets().get(1).getContexts(),","));
  assertEquals("mysql",StringUtils.join(changeLog.getChangeSets().get(1).getDbmsSet(),","));
  assertEquals("nvoxland",changeLog.getChangeSets().get(2).getAuthor());
  assertEquals("3",changeLog.getChangeSets().get(2).getId());
  assertEquals(1,changeLog.getChangeSets().get(2).getChanges().size());
  assertEquals("create table table2 (\n" + "  id int primary key\n" + ");\n"+ "create table table3 (\n"+ "  id int primary key\n"+ ");",((RawSQLChange)changeLog.getChangeSets().get(2).getChanges().get(0)).getSql());
  assertNull(((RawSQLChange)changeLog.getChangeSets().get(2).getChanges().get(0)).getEndDelimiter());
  assertTrue(((RawSQLChange)changeLog.getChangeSets().get(2).getChanges().get(0)).isSplittingStatements());
  assertTrue(((RawSQLChange)changeLog.getChangeSets().get(2).getChanges().get(0)).isStrippingComments());
}
