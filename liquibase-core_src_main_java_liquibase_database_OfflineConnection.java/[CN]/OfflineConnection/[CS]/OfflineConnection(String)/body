{
  this.url=url;
  Matcher matcher=Pattern.compile("offline:(\\w+)\\??(.*)").matcher(url);
  if (!matcher.matches()) {
    throw new UnexpectedLiquibaseException("Could not parse offline url " + url);
  }
  this.databaseShortName=matcher.group(1).toLowerCase();
  String params=StringUtils.trimToNull(matcher.group(2));
  if (params != null) {
    String[] keyValues=params.split("&");
    for (    String param : keyValues) {
      String[] split=param.split("=");
      this.params.put(split[0],split[1]);
    }
  }
  this.productName="Offline " + databaseShortName;
  for (  Map.Entry<String,String> paramEntry : this.params.entrySet()) {
    if (paramEntry.getKey().equals("version")) {
      this.productVersion=paramEntry.getValue();
      String[] versionParts=productVersion.split("\\.");
      try {
        this.databaseMajorVersion=Integer.valueOf(versionParts[0]);
        if (versionParts.length > 1) {
          this.databaseMinorVersion=Integer.valueOf(versionParts[1]);
        }
      }
 catch (      NumberFormatException e) {
        LogFactory.getInstance().getLog().warning("Cannot parse database version " + productVersion);
      }
    }
 else     if (paramEntry.getKey().equals("productName")) {
      this.productName=paramEntry.getValue();
    }
 else     if (paramEntry.getKey().equals("catalog")) {
      this.catalog=this.params.get("catalog");
    }
 else {
      this.databaseParams.put(paramEntry.getKey(),paramEntry.getValue());
    }
  }
}
