{
  boolean defaultDelimiter=endDelimiter == null;
  StringClauses[] parsedList=SqlParser.parse(multiLineSQL,splitStatements,true,!stripComments,!splitStatements);
  List<String> returnArray=new ArrayList<String>();
  for (  StringClauses parsed : parsedList) {
    String currentString;
    if (defaultDelimiter) {
      currentString=parsed.toString();
    }
 else {
      currentString="";
      for (      Object piece : parsed.toArray(false)) {
        if (splitStatements && piece instanceof String && ((String)piece).matches(endDelimiter)) {
          currentString=StringUtils.trimToNull(currentString);
          if (currentString != null) {
            returnArray.add(currentString);
          }
          currentString="";
        }
 else {
          currentString+=piece;
        }
      }
    }
    currentString=StringUtils.trimToNull(currentString);
    if (currentString != null) {
      returnArray.add(currentString);
    }
  }
  return returnArray.toArray(new String[returnArray.size()]);
}
