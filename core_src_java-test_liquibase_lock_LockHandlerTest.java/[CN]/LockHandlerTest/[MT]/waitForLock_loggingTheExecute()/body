{
  new DatabaseTestTemplate().testOnAvailableDatabases(new DatabaseTest(){
    public void performTest(    Database database) throws Exception {
      try {
        new JdbcTemplate(database).execute(new DropTableStatement(null,database.getDatabaseChangeLogTableName(),false));
      }
 catch (      JDBCException e) {
        ;
      }
      try {
        new JdbcTemplate(database).execute(new DropTableStatement(null,database.getDatabaseChangeLogLockTableName(),false));
      }
 catch (      JDBCException e) {
        ;
      }
      database.commit();
      Database clearDatabase=database.getClass().newInstance();
      clearDatabase.setConnection(database.getConnection());
      JdbcTemplate originalTemplate=clearDatabase.getJdbcTemplate();
      clearDatabase.setJdbcTemplate(new JdbcOutputTemplate(new StringWriter(),clearDatabase));
      LockHandler lockHandler=LockHandler.getInstance(clearDatabase);
      lockHandler.waitForLock();
      clearDatabase.setJdbcTemplate(originalTemplate);
      lockHandler.waitForLock();
      clearDatabase.getJdbcTemplate().execute(clearDatabase.getSelectChangeLogLockSQL());
    }
  }
);
}
