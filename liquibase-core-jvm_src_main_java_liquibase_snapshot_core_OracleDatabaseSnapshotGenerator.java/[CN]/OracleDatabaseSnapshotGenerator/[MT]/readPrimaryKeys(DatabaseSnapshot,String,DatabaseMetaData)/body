{
  Database database=snapshot.getDatabase();
  updateListeners("Reading primary keys for " + database.toString() + " ...");
  List<PrimaryKey> foundPKs=new ArrayList<PrimaryKey>();
  String query="select uc.table_name TABLE_NAME,ucc.column_name COLUMN_NAME,ucc.position KEY_SEQ,uc.constraint_name PK_NAME,ui.tablespace_name TABLESPACE from user_constraints uc,user_indexes ui,user_cons_columns ucc where uc.constraint_type = 'P' and uc.index_name = ui.index_name and uc.constraint_name = ucc.constraint_name";
  Statement statement=((JdbcConnection)database.getConnection()).getUnderlyingConnection().createStatement();
  ResultSet rs=statement.executeQuery(query);
  while (rs.next()) {
    String tableName=convertFromDatabaseName(rs.getString("TABLE_NAME"));
    String tablespace=convertFromDatabaseName(rs.getString("TABLESPACE"));
    String columnName=convertFromDatabaseName(rs.getString("COLUMN_NAME"));
    short position=rs.getShort("KEY_SEQ");
    boolean foundExistingPK=false;
    for (    PrimaryKey pk : foundPKs) {
      if (pk.getTable().getName().equals(tableName)) {
        pk.addColumnName(position - 1,columnName);
        foundExistingPK=true;
      }
    }
    if (!foundExistingPK) {
      PrimaryKey primaryKey=new PrimaryKey();
      primaryKey.setTablespace(tablespace);
      primaryKey.setTable(snapshot.getTable(tableName));
      primaryKey.addColumnName(position - 1,columnName);
      primaryKey.setName(convertPrimaryKeyName(rs.getString("PK_NAME")));
      foundPKs.add(primaryKey);
    }
  }
  JdbcUtils.closeResultSet(rs);
  JdbcUtils.closeStatement(statement);
  snapshot.getPrimaryKeys().addAll(foundPKs);
}
