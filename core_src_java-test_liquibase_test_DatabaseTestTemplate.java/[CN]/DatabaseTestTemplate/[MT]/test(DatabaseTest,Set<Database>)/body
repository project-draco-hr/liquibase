{
  for (  Database database : databasesToTestOn) {
    try {
      test.performTest(database);
    }
 catch (    ComparisonFailure e) {
      String newMessage="Database Test Failure on " + database;
      if (e.getMessage() != null) {
        newMessage+=": " + e.getMessage();
      }
      ComparisonFailure newError=new ComparisonFailure(newMessage,e.getExpected(),e.getActual());
      newError.setStackTrace(e.getStackTrace());
      throw newError;
    }
catch (    AssertionError e) {
      String newMessage="Database Test Failure on " + database;
      if (e.getMessage() != null) {
        newMessage+=": " + e.getMessage();
      }
      AssertionError newError=new AssertionError(newMessage);
      newError.setStackTrace(e.getStackTrace());
      throw newError;
    }
catch (    Exception e) {
      String newMessage="Database Test Exception on " + database;
      if (e.getMessage() != null) {
        newMessage+=": " + e.getMessage();
      }
      Exception newError=e.getClass().getConstructor(String.class).newInstance(newMessage);
      newError.setStackTrace(e.getStackTrace());
      throw newError;
    }
 finally {
      if (database.getConnection() != null && !database.getAutoCommitMode()) {
        database.getConnection().rollback();
      }
    }
  }
}
