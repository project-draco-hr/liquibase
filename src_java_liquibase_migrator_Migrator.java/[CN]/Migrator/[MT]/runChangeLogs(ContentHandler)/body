{
  try {
    InputStream inputStream=getFileOpener().getResourceAsStream(getMigrationFile());
    if (inputStream == null) {
      throw new MigrationFailedException(getMigrationFile() + " does not exist");
    }
    xmlReader.setContentHandler(contentHandler);
    xmlReader.parse(new InputSource(inputStream));
    inputStream.close();
  }
 catch (  IOException e) {
    throw new MigrationFailedException("Error Reading Migration File: " + e.getMessage(),e);
  }
catch (  SAXParseException e) {
    throw new MigrationFailedException("Error parsing line " + e.getLineNumber() + " column "+ e.getColumnNumber()+ ": "+ e.getMessage());
  }
catch (  SAXException e) {
    Throwable parentCause=e.getException();
    while (parentCause != null) {
      if (parentCause instanceof MigrationFailedException) {
        throw ((MigrationFailedException)parentCause);
      }
      parentCause=parentCause.getCause();
    }
    String reason=e.getMessage();
    if (reason == null) {
      reason="Unknown Reason";
    }
    throw new MigrationFailedException("Invalid Migration File: " + reason,e);
  }
}
