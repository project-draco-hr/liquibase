{
  Liquibase liquibase=getLiquibase();
  try {
    if (isPromptOnNonLocalDatabase() && !liquibase.isSafeToRunUpdate() && UIFactory.getInstance().getFacade().promptForNonLocalDatabase(liquibase.getDatabase())) {
      throw new BuildException("Chose not to run against non-production database");
    }
    if (isDropFirst()) {
      liquibase.dropAll();
    }
    liquibase.updateTestingRollback(getContexts());
  }
 catch (  LiquibaseException e) {
    throw new BuildException("Unable to update database with a rollback test.",e);
  }
}
