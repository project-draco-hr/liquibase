{
  if (chain.isSameObject(databaseObject1,databaseObject2,accordingTo)) {
    return true;
  }
  if (!(databaseObject1 instanceof Schema && databaseObject2 instanceof Schema)) {
    return false;
  }
  CatalogAndSchema thisSchema=accordingTo.correctSchema(((Schema)databaseObject1).toCatalogAndSchema());
  CatalogAndSchema otherSchema=accordingTo.correctSchema(((Schema)databaseObject2).toCatalogAndSchema());
  if (accordingTo.supportsCatalogs()) {
    if (thisSchema.getCatalogName() == null) {
      return otherSchema.getCatalogName() == null || accordingTo.getDefaultCatalogName() == null || accordingTo.getDefaultCatalogName().equalsIgnoreCase(otherSchema.getCatalogName());
    }
    if (!thisSchema.getCatalogName().equalsIgnoreCase(otherSchema.getCatalogName())) {
      return false;
    }
  }
  if (accordingTo.supportsSchemas()) {
    return thisSchema.getSchemaName().equalsIgnoreCase(otherSchema.getSchemaName());
  }
  return true;
}
