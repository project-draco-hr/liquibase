{
  updateListeners("Reading primary keys for " + database.toString() + " ...");
  Schema schema;
  Table relation=null;
  if (container instanceof Schema) {
    schema=(Schema)container;
  }
 else   if (container instanceof Table) {
    relation=(Table)container;
    schema=relation.getSchema();
  }
 else {
    return new PrimaryKey[0];
  }
  List<PrimaryKey> foundPKs=new ArrayList<PrimaryKey>();
  List<Table> tables=new ArrayList<Table>();
  if (relation == null) {
    tables.addAll(Arrays.asList(DatabaseObjectGeneratorFactory.getInstance().getGenerator(Table.class,database).get(schema,database)));
  }
 else {
    tables.add(relation);
  }
  ResultSet rs=null;
  try {
    DatabaseMetaData metaData=getMetaData(database);
    for (    Table table : tables) {
      rs=metaData.getPrimaryKeys(database.getJdbcCatalogName(schema),database.getJdbcSchemaName(schema),table.getName());
      while (rs.next()) {
        String tableName=cleanNameFromDatabase(rs.getString("TABLE_NAME"),database);
        String columnName=cleanNameFromDatabase(rs.getString("COLUMN_NAME"),database);
        short position=rs.getShort("KEY_SEQ");
        boolean foundExistingPK=false;
        for (        PrimaryKey pk : foundPKs) {
          if (pk.getTable().equals(tableName,database)) {
            pk.addColumnName(position - 1,columnName);
            foundExistingPK=true;
          }
        }
        if (!foundExistingPK) {
          PrimaryKey primaryKey=new PrimaryKey();
          primaryKey.setTable(table);
          primaryKey.addColumnName(position - 1,columnName);
          primaryKey.setName(database.correctObjectName(rs.getString("PK_NAME"),PrimaryKey.class));
          foundPKs.add(primaryKey);
        }
      }
      rs.close();
    }
  }
 catch (  SQLException e) {
    throw new DatabaseException(e);
  }
 finally {
    try {
      if (rs != null) {
        rs.close();
      }
    }
 catch (    SQLException ignored) {
    }
  }
  return foundPKs.toArray(new PrimaryKey[foundPKs.size()]);
}
