{
  ResultSet rs=null;
  Statement dropStatement=null;
  try {
    rs=conn.getMetaData().getTables(getCatalogName(),getSchemaName(),null,new String[]{"VIEW"});
    dropStatement=conn.createStatement();
    while (rs.next()) {
      String tableName=rs.getString("TABLE_NAME");
      if (getSystemTablesAndViews().contains(tableName)) {
        continue;
      }
      String sql="DROP VIEW " + tableName;
      try {
        log.finest("Dropping view " + tableName);
        dropStatement.executeUpdate(sql);
      }
 catch (      SQLException e) {
        throw new JDBCException("Error dropping view '" + tableName + "': "+ e.getMessage(),e);
      }
    }
  }
 catch (  SQLException e) {
    throw new JDBCException(e);
  }
 finally {
    if (dropStatement != null) {
      try {
        dropStatement.close();
      }
 catch (      SQLException e) {
        throw new JDBCException(e);
      }
    }
    if (rs != null) {
      try {
        rs.close();
      }
 catch (      SQLException e) {
        throw new JDBCException(e);
      }
    }
  }
}
