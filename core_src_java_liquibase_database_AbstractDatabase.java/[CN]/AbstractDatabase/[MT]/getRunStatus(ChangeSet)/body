{
  if (!doesChangeLogTableExist()) {
    return ChangeSet.RunStatus.NOT_RAN;
  }
  RanChangeSet foundRan=getRanChangeSet(changeSet);
  if (foundRan == null) {
    return ChangeSet.RunStatus.NOT_RAN;
  }
 else {
    if (foundRan.getMd5sum() == null) {
      try {
        log.info("Updating NULL md5sum for " + changeSet.toString());
        DatabaseConnection connection=getConnection();
        PreparedStatement updatePstmt=connection.prepareStatement("UPDATE " + escapeTableName(getDefaultSchemaName(),getDatabaseChangeLogTableName()) + " SET MD5SUM=? WHERE ID=? AND AUTHOR=? AND FILENAME=?");
        updatePstmt.setString(1,changeSet.getMd5sum());
        updatePstmt.setString(2,changeSet.getId());
        updatePstmt.setString(3,changeSet.getAuthor());
        updatePstmt.setString(4,changeSet.getFilePath());
        updatePstmt.executeUpdate();
        updatePstmt.close();
        this.commit();
      }
 catch (      SQLException e) {
        throw new JDBCException(e);
      }
      return ChangeSet.RunStatus.ALREADY_RAN;
    }
 else {
      if (foundRan.getMd5sum().equals(changeSet.getMd5sum())) {
        return ChangeSet.RunStatus.ALREADY_RAN;
      }
 else {
        if (changeSet.shouldRunOnChange()) {
          return ChangeSet.RunStatus.RUN_AGAIN;
        }
 else {
          return ChangeSet.RunStatus.INVALID_MD5SUM;
        }
      }
    }
  }
}
