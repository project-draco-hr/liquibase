{
  WriteExecutor writeExecutor=ExecutorService.getInstance().getWriteExecutor(this);
  try {
    int totalRows=ExecutorService.getInstance().getReadExecutor(this).queryForInt(new RawSqlStatement("SELECT COUNT(*) FROM " + escapeTableName(getLiquibaseSchemaName(),getDatabaseChangeLogTableName())),new ArrayList<SqlVisitor>());
    if (totalRows == 0) {
      throw new JDBCException("Cannot tag an empty database");
    }
    int rowsUpdated=writeExecutor.update(new TagDatabaseStatement(tagString),new ArrayList<SqlVisitor>());
    if (rowsUpdated == 0) {
      throw new JDBCException("Did not tag database change log correctly");
    }
    this.commit();
  }
 catch (  Exception e) {
    throw new JDBCException(e);
  }
}
