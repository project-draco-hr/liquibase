{
  WriteExecutor writeExecutor=ExecutorService.getInstance().getWriteExecutor(this);
  try {
    int totalRows=ExecutorService.getInstance().getReadExecutor(this).queryForInt(new SelectFromDatabaseChangeLogStatement("COUNT(*)"),new ArrayList<SqlVisitor>());
    if (totalRows == 0) {
      ChangeSet emptyChangeSet=new ChangeSet(String.valueOf(new Date().getTime()),"liquibase",false,false,"liquibase-internal","liquibase-internal",null,null);
      this.markChangeSetAsRan(emptyChangeSet);
    }
    int rowsUpdated=writeExecutor.update(new TagDatabaseStatement(tagString),new ArrayList<SqlVisitor>());
    if (rowsUpdated == 0) {
      throw new DatabaseException("Did not tag database change log correctly");
    }
    this.commit();
    ranChangeSetList.get(ranChangeSetList.size() - 1).setTag(tagString);
  }
 catch (  Exception e) {
    throw new DatabaseException(e);
  }
}
