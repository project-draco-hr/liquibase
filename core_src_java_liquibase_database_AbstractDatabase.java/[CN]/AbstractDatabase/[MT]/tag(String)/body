{
  try {
    int totalRows=this.getJdbcTemplate().queryForInt(new RawSqlStatement("SELECT COUNT(*) FROM " + getDatabaseChangeLogTableName()));
    if (totalRows == 0) {
      throw new JDBCException("Cannot tag an empty database");
    }
    Date lastExecutedDate=(Date)this.getJdbcTemplate().queryForObject(createChangeToTagSQL(),Date.class);
    int rowsUpdated=this.getJdbcTemplate().update(createTagSQL(tagString,lastExecutedDate));
    if (rowsUpdated == 0) {
      throw new JDBCException("Did not tag database change log correctly");
    }
    this.commit();
  }
 catch (  Exception e) {
    throw new JDBCException(e);
  }
}
