{
  try {
    int totalRows=new JdbcTemplate(this).queryForInt(new RawSqlStatement("select count(*) from " + getDatabaseChangeLogTableName()));
    if (totalRows == 0) {
      throw new JDBCException("Cannot tag an empty database");
    }
    Date lastExecutedDate=(Date)new JdbcTemplate(this).queryForObject(createChangeToTagSQL(),Date.class);
    int rowsUpdated=new JdbcTemplate(this).update(createTagSQL(tagString,lastExecutedDate));
    if (rowsUpdated == 0) {
      throw new JDBCException("Did not tag database change log correctly");
    }
    getConnection().commit();
  }
 catch (  Exception e) {
    throw new JDBCException(e);
  }
}
