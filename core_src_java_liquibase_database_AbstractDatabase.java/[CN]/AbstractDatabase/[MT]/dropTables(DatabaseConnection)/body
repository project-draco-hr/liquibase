{
  ResultSet rs=null;
  try {
    rs=conn.getMetaData().getTables(getCatalogName(),getSchemaName(),null,getTableTypes());
    while (rs.next()) {
      String tableName=rs.getString("TABLE_NAME");
      String schemaName=rs.getString("TABLE_SCHEM");
      String catalogName=rs.getString("TABLE_CAT");
      if (isSystemTable(catalogName,schemaName,tableName)) {
        continue;
      }
      String type=rs.getString("TABLE_TYPE");
      Change dropChange;
      if ("TABLE".equals(type)) {
        dropChange=new DropTableChange();
        ((DropTableChange)dropChange).setTableName(tableName);
      }
 else       if ("VIEW".equals(type)) {
        dropChange=new DropViewChange();
        ((DropViewChange)dropChange).setViewName(tableName);
      }
 else       if ("SYSTEM TABLE".equals(type)) {
        continue;
      }
 else {
        throw new JDBCException("Unknown type " + type + " for "+ tableName);
      }
      try {
        log.finest("Dropping " + tableName);
        dropChange.executeStatements(this);
      }
 catch (      UnsupportedChangeException e) {
        throw new JDBCException("Error dropping table '" + tableName + "': "+ e.getMessage(),e);
      }
    }
  }
 catch (  SQLException e) {
    throw new JDBCException(e);
  }
 finally {
    if (rs != null) {
      try {
        rs.close();
      }
 catch (      SQLException e) {
        throw new JDBCException(e);
      }
    }
  }
}
