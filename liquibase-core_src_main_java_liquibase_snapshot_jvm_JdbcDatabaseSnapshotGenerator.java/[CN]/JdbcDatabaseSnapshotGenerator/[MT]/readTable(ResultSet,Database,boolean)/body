{
  String rawTableName=tableMetadataResultSet.getString("TABLE_NAME");
  String rawSchemaName=StringUtils.trimToNull(tableMetadataResultSet.getString("TABLE_SCHEM"));
  String rawCatalogName=StringUtils.trimToNull(tableMetadataResultSet.getString("TABLE_CAT"));
  String remarks=StringUtils.trimToNull(tableMetadataResultSet.getString("REMARKS"));
  Table table=new Table(cleanObjectNameFromDatabase(rawTableName));
  table.setRemarks(remarks);
  table.setDatabase(database);
  table.setRawSchemaName(rawSchemaName);
  table.setRawCatalogName(rawCatalogName);
  table.setSchema(getSchemaFromJdbcInfo(rawSchemaName,rawCatalogName,database));
  if (readColumns) {
    Schema rawSchema=database.correctSchema(new Schema(table.getRawCatalogName(),table.getRawSchemaName()));
    ResultSet columnMetadataResultSet=getMetaData(database).getColumns(getJdbcCatalogName(rawSchema),getJdbcSchemaName(rawSchema),rawTableName,null);
    try {
      while (columnMetadataResultSet.next()) {
        table.getColumns().add(readColumn(convertResultSetToMap(columnMetadataResultSet),table,database));
      }
    }
  finally {
      columnMetadataResultSet.close();
    }
  }
  return table;
}
