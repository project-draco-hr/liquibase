{
  Database database=snapshot.getDatabase();
  updateListeners("Reading primary keys for " + database.toString() + " ...");
  List<PrimaryKey> foundPKs=new ArrayList<PrimaryKey>();
  for (  Table table : snapshot.getDatabaseObjects(schema,Table.class)) {
    ResultSet rs=databaseMetaData.getPrimaryKeys(schema.getCatalogName(),schema.getName(),table.getName());
    try {
      while (rs.next()) {
        String tableName=cleanObjectNameFromDatabase(rs.getString("TABLE_NAME"));
        String columnName=cleanObjectNameFromDatabase(rs.getString("COLUMN_NAME"));
        short position=rs.getShort("KEY_SEQ");
        if (database.isLiquibaseTable(tableName)) {
          continue;
        }
        boolean foundExistingPK=false;
        for (        PrimaryKey pk : foundPKs) {
          if (pk.getTable().getName().equals(tableName)) {
            pk.addColumnName(position - 1,columnName);
            foundExistingPK=true;
          }
        }
        if (!foundExistingPK) {
          PrimaryKey primaryKey=new PrimaryKey();
          primaryKey.setTable(table);
          primaryKey.addColumnName(position - 1,columnName);
          primaryKey.setName(database.correctPrimaryKeyName(rs.getString("PK_NAME")));
          foundPKs.add(primaryKey);
        }
      }
    }
  finally {
      rs.close();
    }
  }
  snapshot.addDatabaseObjects(foundPKs.toArray(new PrimaryKey[foundPKs.size()]));
}
