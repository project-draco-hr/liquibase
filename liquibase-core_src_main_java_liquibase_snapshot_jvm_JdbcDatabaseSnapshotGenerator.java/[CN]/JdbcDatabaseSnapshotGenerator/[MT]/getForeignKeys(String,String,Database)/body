{
  List<ForeignKey> fkList=new ArrayList<ForeignKey>();
  try {
    String dbCatalog=database.convertRequestedSchemaToCatalog(schemaName);
    String dbSchema=database.convertRequestedSchemaToSchema(schemaName);
    ResultSet rs=getMetaData(database).getImportedKeys(dbCatalog,dbSchema,convertTableNameToDatabaseTableName(foreignKeyTableName));
    try {
      while (rs.next()) {
        ForeignKeyInfo fkInfo=fillForeignKeyInfo(rs);
        fkList.add(generateForeignKey(fkInfo,database,fkList));
      }
    }
  finally {
      rs.close();
    }
    return fkList;
  }
 catch (  Exception e) {
    throw new DatabaseException(e);
  }
}
