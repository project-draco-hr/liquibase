{
  DatabaseSnapshot snapshot;
  try {
    snapshot=DatabaseSnapshotGeneratorFactory.getInstance().createSnapshot(database,new DiffControl(schema,PrimaryKey.class));
  }
 catch (  DatabaseException e) {
    throw new UnexpectedLiquibaseException(e);
  }
  if (tableName != null) {
    return snapshot.getPrimaryKeyForTable(schema,tableName) != null;
  }
 else   if (primaryKeyName != null) {
    return snapshot.getPrimaryKeyForTable(schema,primaryKeyName) != null;
  }
 else {
    throw new UnexpectedLiquibaseException("hasPrimaryKey requires a tableName or primaryKeyName");
  }
}
