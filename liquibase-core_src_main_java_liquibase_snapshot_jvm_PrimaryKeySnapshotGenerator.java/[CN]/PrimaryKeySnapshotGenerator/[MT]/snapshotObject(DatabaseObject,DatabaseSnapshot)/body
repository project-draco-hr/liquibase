{
  Database database=snapshot.getDatabase();
  Schema schema=example.getSchema();
  String searchTableName=null;
  if (((PrimaryKey)example).getTable() != null) {
    searchTableName=((PrimaryKey)example).getTable().getName();
    searchTableName=database.correctObjectName(searchTableName,Table.class);
  }
  ResultSet rs=null;
  try {
    DatabaseMetaData metaData=getMetaData(database);
    rs=metaData.getPrimaryKeys(((AbstractJdbcDatabase)database).getJdbcCatalogName(schema),((AbstractJdbcDatabase)database).getJdbcSchemaName(schema),searchTableName);
    PrimaryKey returnKey=null;
    while (rs.next()) {
      if (example.getName() != null && !example.getName().equals(rs.getString("PK_NAME"))) {
        continue;
      }
      String columnName=cleanNameFromDatabase(rs.getString("COLUMN_NAME"),database);
      short position=rs.getShort("KEY_SEQ");
      if (returnKey == null) {
        returnKey=new PrimaryKey();
        CatalogAndSchema tableSchema=((AbstractJdbcDatabase)database).getSchemaFromJdbcInfo(rs.getString("TABLE_CAT"),rs.getString("TABLE_SCHEM"));
        returnKey.setTable((Table)new Table().setName(rs.getString("TABLE_NAME")).setSchema(new Schema(tableSchema.getCatalogName(),tableSchema.getSchemaName())));
        returnKey.setName(rs.getString("PK_NAME"));
      }
      returnKey.addColumnName(position - 1,columnName);
    }
    rs.close();
    return returnKey;
  }
 catch (  SQLException e) {
    throw new DatabaseException(e);
  }
 finally {
    try {
      if (rs != null) {
        rs.close();
      }
    }
 catch (    SQLException ignored) {
    }
  }
}
