{
  StringBuffer sql=new StringBuffer("{call " + statement.getProcedureName());
  List<String> parameters=statement.getParameters();
  if (parameters.size() > 0) {
    sql.append("(");
    for (    Object param : parameters) {
      sql.append("?,");
    }
    sql.deleteCharAt(sql.lastIndexOf(","));
    sql.append(")");
  }
  sql.append("}");
  CallableStatement pstmt=((JdbcConnection)database.getConnection()).getUnderlyingConnection().prepareCall(sql.toString());
  for (int i=0; i < parameters.size(); i++) {
    String param=parameters.get(i);
    int type=((JdbcDatabaseSnapshotGenerator)DatabaseSnapshotGeneratorFactory.getInstance().getGenerator(database)).getDatabaseType(statement.getParameterType(param),database);
    if (param == null) {
      pstmt.setNull(i + 1,type);
    }
 else {
      pstmt.setObject(i + 1,param,type);
    }
  }
  return pstmt;
}
