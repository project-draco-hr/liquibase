{
  DiffControl diffControl=new DiffControl(catalogName,schemaName,null,null,diffTypes);
  diffControl.setDataDir(dataDir);
  diffControl.addStatusListener(new OutDiffStatusListener());
  DatabaseSnapshot originalDatabaseSnapshot=DatabaseSnapshotGeneratorFactory.getInstance().createSnapshot(originalDatabase,diffControl,DiffControl.DatabaseRole.REFERENCE);
  DiffResult diffResult=DiffGeneratorFactory.getInstance().compare(originalDatabaseSnapshot,new DatabaseSnapshot(null,diffControl.getSchemas(DiffControl.DatabaseRole.REFERENCE)),diffControl);
  DiffToChangeLog changeLogWriter=new DiffToChangeLog(diffResult);
  changeLogWriter.setChangeSetAuthor(author);
  changeLogWriter.setChangeSetContext(context);
  if (StringUtils.trimToNull(changeLogFile) != null) {
    changeLogWriter.print(changeLogFile);
  }
 else {
    PrintStream outputStream=System.out;
    changeLogWriter.print(outputStream);
  }
}
