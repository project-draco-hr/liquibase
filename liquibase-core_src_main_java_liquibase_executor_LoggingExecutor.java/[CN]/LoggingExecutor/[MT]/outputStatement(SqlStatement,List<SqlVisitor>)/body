{
  try {
    if (SqlGeneratorFactory.getInstance().requiresCurrentDatabaseMetadata(sql,database)) {
      throw new DatabaseException(sql.getClass().getSimpleName() + " requires access to up to date database metadata which is not available in SQL output mode");
    }
    for (    String statement : applyVisitors(sql,sqlVisitors)) {
      if (statement == null) {
        continue;
      }
      output.write(statement);
      if (database instanceof MSSQLDatabase) {
        output.write(StreamUtil.getLineSeparator());
        output.write("GO");
      }
 else {
        String endDelimiter=";";
        if (sql instanceof RawSqlStatement) {
          endDelimiter=((RawSqlStatement)sql).getEndDelimiter();
        }
        if (!statement.endsWith(endDelimiter)) {
          output.write(endDelimiter);
        }
      }
      output.write(StreamUtil.getLineSeparator());
      output.write(StreamUtil.getLineSeparator());
    }
  }
 catch (  IOException e) {
    throw new DatabaseException(e);
  }
}
