{
  new DatabaseTestTemplate().testOnAllDatabases(new DatabaseTest(){
    public void performTest(    Database database) throws Exception {
      AddPrimaryKeyChange change=new AddPrimaryKeyChange();
      change.setSchemaName("SCHEMA_NAME");
      change.setTableName("TABLE_NAME");
      change.setColumnNames("COL_HERE");
      change.setConstraintName("PK_NAME");
      change.setTablespace("TABLESPACE_NAME");
      SqlStatement[] sqlStatements=change.generateStatements(database);
      if (database instanceof DB2Database) {
        assertEquals(2,sqlStatements.length);
        assertTrue(sqlStatements[1] instanceof ReorganizeTableStatement);
        assertEquals("SCHEMA_NAME",((ReorganizeTableStatement)sqlStatements[1]).getSchemaName());
        assertEquals("TABLE_NAME",((ReorganizeTableStatement)sqlStatements[1]).getTableName());
      }
 else {
        assertEquals(1,sqlStatements.length);
      }
      assertTrue(sqlStatements[0] instanceof AddPrimaryKeyStatement);
      assertEquals("SCHEMA_NAME",((AddPrimaryKeyStatement)sqlStatements[0]).getSchemaName());
      assertEquals("TABLE_NAME",((AddPrimaryKeyStatement)sqlStatements[0]).getTableName());
      assertEquals("COL_HERE",((AddPrimaryKeyStatement)sqlStatements[0]).getColumnNames());
      assertEquals("PK_NAME",((AddPrimaryKeyStatement)sqlStatements[0]).getConstraintName());
      assertEquals("TABLESPACE_NAME",((AddPrimaryKeyStatement)sqlStatements[0]).getTablespace());
    }
  }
);
}
