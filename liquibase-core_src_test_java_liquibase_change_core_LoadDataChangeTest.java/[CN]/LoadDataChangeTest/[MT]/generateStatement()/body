{
  LoadDataChange refactoring=new LoadDataChange();
  refactoring.setSchemaName("SCHEMA_NAME");
  refactoring.setTableName("TABLE_NAME");
  refactoring.setFile("liquibase/change/core/sample.data1.csv");
  refactoring.setResourceAccessor(new ClassLoaderResourceAccessor());
  SqlStatement[] sqlStatements=refactoring.generateStatements(new MockDatabase());
  assertEquals(2,sqlStatements.length);
  assertTrue(sqlStatements[0] instanceof InsertStatement);
  assertTrue(sqlStatements[1] instanceof InsertStatement);
  assertEquals("SCHEMA_NAME",((InsertStatement)sqlStatements[0]).getSchemaName());
  assertEquals("TABLE_NAME",((InsertStatement)sqlStatements[0]).getTableName());
  assertEquals("Bob Johnson",((InsertStatement)sqlStatements[0]).getColumnValue("name"));
  assertEquals("bjohnson",((InsertStatement)sqlStatements[0]).getColumnValue("username"));
  assertEquals("SCHEMA_NAME",((InsertStatement)sqlStatements[1]).getSchemaName());
  assertEquals("TABLE_NAME",((InsertStatement)sqlStatements[1]).getTableName());
  assertEquals("John Doe",((InsertStatement)sqlStatements[1]).getColumnValue("name"));
  assertEquals("jdoe",((InsertStatement)sqlStatements[1]).getColumnValue("username"));
}
