{
  Database referenceDatabase=referenceSnapshot.getDatabase();
  Database comparisonDatabase;
  if (comparisonSnapshot == null) {
    comparisonDatabase=referenceSnapshot.getDatabase();
    comparisonSnapshot=new JdbcDatabaseSnapshot(referenceSnapshot.getSnapshotControl(),referenceDatabase);
  }
 else {
    comparisonDatabase=comparisonSnapshot.getDatabase();
  }
  return getGenerator(referenceDatabase,comparisonDatabase).compare(referenceSnapshot,comparisonSnapshot,compareControl);
}
